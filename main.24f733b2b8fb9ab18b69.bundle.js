(self.webpackChunk_amp_ui_commerce_commerce_cwa_app=self.webpackChunk_amp_ui_commerce_commerce_cwa_app||[]).push([[179],{4170:(e,n,t)=>{"use strict";var r=t(5861),i=t(7757),o=t.n(i),a=t(5893),s=t(7294),c=t(3935),d=t(9711),l=t(6974),u=t(2928);const p=(e,n={})=>{const{releaseVersion:t,environmentOverride:r,integrations:i}=n;u.Z.init({integrations:i,project:e,environment:"prod",release:t||"0.0.0"})},m=e=>{let n=null;return(...t)=>n||(n=e(...t).finally((()=>{n=null})),n)},h=(e,n)=>Promise.race([e,new Promise(((e,t)=>setTimeout(t,n)))]),f={BD:"BGD",BE:"BEL",BF:"BFA",BG:"BGR",BA:"BIH",BB:"BRB",WF:"WLF",BL:"BLM",BM:"BMU",BN:"BRN",BO:"BOL",BH:"BHR",BI:"BDI",BJ:"BEN",BT:"BTN",JM:"JAM",BV:"BVT",BW:"BWA",WS:"WSM",BQ:"BES",BR:"BRA",BS:"BHS",JE:"JEY",BY:"BLR",BZ:"BLZ",RU:"RUS",RW:"RWA",RS:"SRB",TL:"TLS",RE:"REU",TM:"TKM",TJ:"TJK",RO:"ROU",TK:"TKL",GW:"GNB",GU:"GUM",GT:"GTM",GS:"SGS",GR:"GRC",GQ:"GNQ",GP:"GLP",JP:"JPN",GY:"GUY",GG:"GGY",GF:"GUF",GE:"GEO",GD:"GRD",GB:"GBR",GA:"GAB",SV:"SLV",GN:"GIN",GM:"GMB",GL:"GRL",GI:"GIB",GH:"GHA",OM:"OMN",TN:"TUN",JO:"JOR",HR:"HRV",HT:"HTI",HU:"HUN",HK:"HKG",HN:"HND",HM:"HMD",VE:"VEN",PR:"PRI",PS:"PSE",PW:"PLW",PT:"PRT",SJ:"SJM",PY:"PRY",IQ:"IRQ",PA:"PAN",PF:"PYF",PG:"PNG",PE:"PER",PK:"PAK",PH:"PHL",PN:"PCN",PL:"POL",PM:"SPM",ZM:"ZMB",EH:"ESH",EE:"EST",EG:"EGY",ZA:"ZAF",EC:"ECU",IT:"ITA",VN:"VNM",SB:"SLB",ET:"ETH",SO:"SOM",ZW:"ZWE",SA:"SAU",ES:"ESP",ER:"ERI",ME:"MNE",MD:"MDA",MG:"MDG",MF:"MAF",MA:"MAR",MC:"MCO",UZ:"UZB",MM:"MMR",ML:"MLI",MO:"MAC",MN:"MNG",MH:"MHL",MK:"MKD",MU:"MUS",MT:"MLT",MW:"MWI",MV:"MDV",MQ:"MTQ",MP:"MNP",MS:"MSR",MR:"MRT",IM:"IMN",UG:"UGA",TZ:"TZA",MY:"MYS",MX:"MEX",IL:"ISR",FR:"FRA",IO:"IOT",SH:"SHN",FI:"FIN",FJ:"FJI",FK:"FLK",FM:"FSM",FO:"FRO",NI:"NIC",NL:"NLD",NO:"NOR",NA:"NAM",VU:"VUT",NC:"NCL",NE:"NER",NF:"NFK",NG:"NGA",NZ:"NZL",NP:"NPL",NR:"NRU",NU:"NIU",CK:"COK",XK:"XKX",CI:"CIV",CH:"CHE",CO:"COL",CN:"CHN",CM:"CMR",CL:"CHL",CC:"CCK",CA:"CAN",CG:"COG",CF:"CAF",CD:"COD",CZ:"CZE",CY:"CYP",CX:"CXR",CR:"CRI",CW:"CUW",CV:"CPV",CU:"CUB",SZ:"SWZ",SY:"SYR",SX:"SXM",KG:"KGZ",KE:"KEN",SS:"SSD",SR:"SUR",KI:"KIR",KH:"KHM",KN:"KNA",KM:"COM",ST:"STP",SK:"SVK",KR:"KOR",SI:"SVN",KP:"PRK",KW:"KWT",SN:"SEN",SM:"SMR",SL:"SLE",SC:"SYC",KZ:"KAZ",KY:"CYM",SG:"SGP",SE:"SWE",SD:"SDN",DO:"DOM",DM:"DMA",DJ:"DJI",DK:"DNK",VG:"VGB",DE:"DEU",YE:"YEM",DZ:"DZA",US:"USA",UY:"URY",YT:"MYT",UM:"UMI",LB:"LBN",LC:"LCA",LA:"LAO",TV:"TUV",TW:"TWN",TT:"TTO",TR:"TUR",LK:"LKA",LI:"LIE",LV:"LVA",TO:"TON",LT:"LTU",LU:"LUX",LR:"LBR",LS:"LSO",TH:"THA",TF:"ATF",TG:"TGO",TD:"TCD",TC:"TCA",LY:"LBY",VA:"VAT",VC:"VCT",AE:"ARE",AD:"AND",AG:"ATG",AF:"AFG",AI:"AIA",VI:"VIR",IS:"ISL",IR:"IRN",AM:"ARM",AL:"ALB",AO:"AGO",AQ:"ATA",AS:"ASM",AR:"ARG",AU:"AUS",AT:"AUT",AW:"ABW",IN:"IND",AX:"ALA",AZ:"AZE",IE:"IRL",ID:"IDN",UA:"UKR",QA:"QAT",MZ:"MOZ"};function g(e,n,{retryLimit:t=2}={}){let r=0;const i=async(...o)=>{++r;try{return await h(e(...o),n)}catch(e){if(r-1<t)return await h(i(...o),n);throw e}};return i}const y=(e,n)=>{const t=e.includes("?")?"&":"?";return`${e}${t}${(e=>Object.entries(e).map((([e,n])=>void 0!==n&&`${encodeURIComponent(e)}=${encodeURIComponent(n)}`)).filter(Boolean).join("&"))(n)}`};var v,C;!function(e){e.AddFunds="addFunds",e.Channel="channel",e.KoreaAgeVerification="koreaAgeVerification",e.Metrics="metrics",e.Music="music",e.PaymentInfos="paymentInfos",e.PaymentVerification="paymentVerification",e.Payments="payments",e.PaymentsV2="paymentsV2",e.Preorders="preorders",e.PurchaseHistory="purchaseHistory",e.Psd2="psd2",e.Redeem="redeem",e.RefundRequest="refundRequest",e.SubscriptionV2="subscriptionsV2",e.SubscriptionV3="subscriptionsV3",e.Terms="terms"}(v||(v={})),function(e){e.Foreground="BE-FGD"}(C||(C={}));const b="itunes",A="https://buy.itunes.apple.com",S="https://play.itunes.apple.com",x="https://speedysub.itunes.apple.com",M={link:"tv",multidev:"tv"},P=(e,n)=>e.replace("{mediaDomain}",M[n]||n),I=e=>(e=>P("https://play.{mediaDomain}.apple.com",e))(e||b),O=e=>(e=>P("https://buy.{mediaDomain}.apple.com",e))(e||b),j={AFG:"143610",AGO:"143564",AIA:"143538",ALB:"143575",AND:"143611",ARE:"143481",ARG:"143505",ARM:"143524",ATG:"143540",AUS:"143460",AUT:"143445",AZE:"143568",BEL:"143446",BEN:"143576",BFA:"143578",BGD:"143490",BGR:"143526",BHR:"143559",BHS:"143539",BIH:"143612",BLR:"143565",BLZ:"143555",BMU:"143542",BOL:"143556",BRA:"143503",BRB:"143541",BRN:"143560",BTN:"143577",BWA:"143525",CAF:"143623",CAN:"143455",CHE:"143459",CHL:"143483",CHN:"143465",CIV:"143527",CMR:"143574",COD:"143613",COG:"143582",COL:"143501",CPV:"143580",CRI:"143495",CYM:"143544",CYP:"143557",CZE:"143489",DEU:"143443",DMA:"143545",DNK:"143458",DOM:"143508",DZA:"143563",ECU:"143509",EGY:"143516",ESP:"143454",EST:"143518",ETH:"143569",FIN:"143447",FJI:"143583",FRA:"143442",FSM:"143591",GAB:"143614",GBR:"143444",GEO:"143615",GHA:"143573",GIN:"143616",GMB:"143584",GNB:"143585",GRC:"143448",GRD:"143546",GTM:"143504",GUY:"143553",HKG:"143463",HND:"143510",HRV:"143494",HUN:"143482",IDN:"143476",IND:"143467",IRL:"143449",IRQ:"143617",ISL:"143558",ISR:"143491",ITA:"143450",JAM:"143511",JOR:"143528",JPN:"143462",KAZ:"143517",KEN:"143529",KGZ:"143586",KHM:"143579",KNA:"143548",KOR:"143466",KWT:"143493",LAO:"143587",LBN:"143497",LBR:"143588",LBY:"143567",LCA:"143549",LIE:"143522",LKA:"143486",LTU:"143520",LUX:"143451",LVA:"143519",MAC:"143515",MAR:"143620",MCO:"143618",MDA:"143523",MDG:"143531",MDV:"143488",MEX:"143468",MKD:"143530",MLI:"143532",MLT:"143521",MMR:"143570",MNE:"143619",MNG:"143592",MOZ:"143593",MRT:"143590",MSR:"143547",MUS:"143533",MWI:"143589",MYS:"143473",NAM:"143594",NER:"143534",NGA:"143561",NIC:"143512",NLD:"143452",NOR:"143457",NPL:"143484",NRU:"143606",NZL:"143461",OMN:"143562",PAK:"143477",PAN:"143485",PER:"143507",PHL:"143474",PLW:"143595",PNG:"143597",POL:"143478",PRT:"143453",PRY:"143513",PSE:"143596",QAT:"143498",ROU:"143487",RUS:"143469",RWA:"143621",SAU:"143479",SEN:"143535",SGP:"143464",SLB:"143601",SLE:"143600",SLV:"143506",SRB:"143500",STP:"143598",SUR:"143554",SVK:"143496",SVN:"143499",SWE:"143456",SWZ:"143602",SYC:"143599",TCA:"143552",TCD:"143581",THA:"143475",TJK:"143603",TKM:"143604",TON:"143608",TTO:"143551",TUN:"143536",TUR:"143480",TWN:"143470",TZA:"143572",UGA:"143537",UKR:"143492",URY:"143514",USA:"143441",UZB:"143566",VCT:"143550",VEN:"143502",VGB:"143543",VNM:"143471",VUT:"143609",WSM:"143607",XKX:"143624",YEM:"143571",ZAF:"143472",ZMB:"143622",ZWE:"143605"},w="https://sandbox.itunes.apple.com",L="https://mzstorekit.itunes.apple.com",E="initiateChallenge",D="createAccountFieldsSrv",N="paymentInfos",T="paymentInfosAdd",R="paymentInfosEdit",U="paymentInfosRemove",k="editShippingAddressSrv",F="deleteShippingAddress",B="reorderStackablePaymentsSrv",W="verifyChallenge",V="getSubscriptionDetails",_="https://finance-app.itunes.apple.com/",Z=`${S}/WebObjects/MZPlay.woa/wa/createAccountFieldsSrv`,$={contentBonusOfferRedemptionEnabled:!1},K={redirect3DSecureUrl:`${A}/WebObjects/MZFinance.woa/wa/secure3dRedirect`,accountCardType:`${A}/account/card/type`,modifyAccount:`${A}/WebObjects/MZFinance.woa/wa/accountSummary`,"acknowledge-message":`${A}/commerce/messages/app/inbox/acknowledge`,addFundsInfoSrv:`${A}/WebObjects/MZFinance.woa/wa/addFundsInfoSrv`,addFundsOtherSrv:`${S}/WebObjects/MZPlay.woa/wa/addFundsOtherSrv`,addFundsSuccessSrv:`${A}/WebObjects/MZFinance.woa/wa/addFundsSuccessSrv`,AddFundsUrl:`${A}/commerce/payments/addFundsUrl`,addFundsCancelAutoReloadSrv:`${A}/WebObjects/MZFinance.woa/wa/addFundsCancelAutoReloadSrv`,addFundsAutoReloadInfoSrv:`${A}/WebObjects/MZFinance.woa/wa/addFundsAutoReloadInfoSrv`,assignSubscriptionBeneficiary:`${A}/commerce/account/subscriptions/assignBeneficiary`,bankTokenUrl:`${A}/payment/referenceData/bankToken/list`,"financeApp.baseUrl":_,paymentInformationUrl:`${_}account/manage-payments`,getSubscriptionAccountPreferences:"https://speedysub.itunes.apple.com/subscription/v3/manage/account/preferences",getVerificationUrl:`${A}/commerce/payments/getVerificationUrl`,verificationUrl:`${A}/commerce/payments/verificationUrl`,startExternalVerification:`${A}/account/payments/startExternalVerification`,getExternalVerificationStatus:`${A}/payment/getExternalVerificationStatus`,getSubscriptionsSrv:`${A}/commerce/account/subscriptions`,getSubscriptionInfoSrv:`${A}/commerce/account/subscriptions/detail`,idVerificationFieldsSrv:`${A}/account/idverification/fields`,[E]:`${A}/account/challenge/initiate`,initiateIdVerification:`${A}/account/idverification/initiate`,invoiceReductionSrv:`${A}/commerce/account/flags/generic`,isInvoiceReductionEnabled:!1,isBundleEnabled:!1,isKoreaAgeVerificationEnabled:!1,isManagePaymentsEnabled:!1,isManageIcloudStorageEnabled:"false",language:"en-us",[D]:Z,[D]:Z,metrics:{metricsUrl:"https://xp.apple.com/report",compoundSeparator:"_",metricsBase:{storeFront:j.USA}},[N]:`${A}/account/stackable/paymentInfos`,[T]:`${A}/account/v1/stackable/paymentInfos/add`,[R]:`${A}/account/v1/stackable/paymentInfos/{paymentId}/edit`,[U]:`${A}/account/stackable/paymentInfos/{paymentId}/delete`,paymentInfosRemoveApplePayClassic:`${A}/account/applePayClassic/paymentInfos/{paymentId}/delete`,paymentOptionsSrv:`${A}/account/paymentOptions`,addBillingInfoSrv:`${A}/WebObjects/MZFinance.woa/wa/addOrEditBillingInfoSrv`,addBillingInfoSrvV2:`${A}/account/v1/stackable/paymentInfos/add`,editBillingInfoSrv:`${A}/WebObjects/MZFinance.woa/wa/addOrEditBillingInfoSrv`,editBillingInfoSrvV2:`${A}/account/v1/stackable/paymentInfos/{paymentId}/edit`,legacyEditBillingInfoSrvV2:`${A}/account/v1/nonstackable/paymentInfos/edit`,aurumEditAddress:`${A}/account/billingAddress/{paymentId}/edit`,[k]:`${A}/account/shippingAddress/edit`,[F]:`${A}/account/shippingAddress/delete`,reinitiateIdVerification:`${A}/account/idverification/reinitiate`,sandboxIntroOfferStatus:`${w}/commerce/sandbox/freeTrialStatus`,sandboxResetIntroOffer:`${w}/commerce/sandbox/v2/resetIntroOffer`,getStackablePaymentsSrv:`${A}/account/stackable/paymentInfos`,applePayPaymentSession:`${A}/account/stackable/applePay/paymentSession`,paymentInfoWithApplePay:`${A}/account/stackable/applePay/paymentInfos`,"apple-pay-classic-payment-infos-url":`${A}/account/applePayClassic/paymentInfos`,"apple-pay-classic-subscription-infos-url":`${A}/account/applePayClassic/paymentInfos/{paymentId}/subscriptionInfos`,preorderItemsSrv:`${A}/WebObjects/MZFinance.woa/wa/getCancellablePreorderItemsSrv`,preordersUrl:`${_}account/preorders`,cancelPreorderItemsSrv:`${A}/WebObjects/MZFinance.woa/wa/cancelPreorderItemSrv`,applePayEnroll:`${A}/account/stackable/applePay/enroll`,deleteStackablePaymentSrv:`${A}/account/stackable/paymentInfos`,[B]:`${A}/account/stackable/paymentInfos/ordering`,getSubscriptionList:`${x}/subscription/v3/manage/list`,[V]:`${x}/subscription/v3/manage/detail`,getUnbundleOptions:`${x}/subscription/v3/manage/unbundleOptions`,"toggle-account-family-sharing":`${A}/commerce/family/sharing/account/toggle`,"toggle-family-sharing":`${A}/commerce/family/sharing/toggle`,unbundleSubscriptionOptionsSrv:`${A}/commerce/account/subscriptions/unbundleOptions`,unbundleSubscriptionSrv:`${A}/commerce/account/subscriptions/unbundle`,updateAutoRenewStateSrv:`${A}/WebObjects/MZFinance.woa/wa/updateAutoRenewStateSrv`,updateIcloudStorageSrv:`${A}/commerce/account/subscriptions/icloud/update`,verification_kit_init:`${A}/account/web/infoRefresh`,[W]:`${A}/account/challenge/verify`,verifyIdVerification:`${A}/account/idverification/verify`,verifyPayment:`${A}/account/verifyPayment`,getTermsByCountryAndTypeSrv:`${A}/WebObjects/MZFinance.woa/wa/getTermsByCountryAndTypeSrv`,"terms-check":`${A}/WebObjects/MZFinance.woa/wa/termsCheckSrv`,emailTermsSrv:`${A}/WebObjects/MZFinance.woa/wa/emailTermsSrv`,getCarmConfigure:`${A}/WebObjects/MZFinance.woa/wa/getCarmConfigure`,sendCarmOtp:`${A}/WebObjects/MZFinance.woa/wa/sendCarmOtp`,resendCarmOtp:`${A}/WebObjects/MZFinance.woa/wa/resendCarmOtp`,validateCarm:`${A}/WebObjects/MZFinance.woa/wa/validateCarm`,"apple-pay-classic-settings-url":`${A}/account/applePayClassic/settings`,isPsd2LoggingEnabled:!0,psd2LoggingUrl:`${A}/payment/psd2SessionState`,productInfo:`${A}/commerce/productInfo`,redeemCodeSrv:`${A}/commerce/redeemCodeSrv`,redeemInfo:`${A}/commerce/redeemInfo`,redeemValidateIdUrl:`${A}/WebObjects/MZFinance.woa/wa/redeemValidateId`,redeemMarketingUrl:"https://apps.apple.com/redeem/promo/api/v1/redirect",redeemCodeLanding:"https://apps.apple.com/redeem/",declineBonus:`${A}/commerce/content/declineBonus`,accountSummaryGraphQL:"https://buy.itunes.apple.com/account/v1/summary/graphql",appleIdSiteUrl:"https://appleid.apple.com",buySubscription:`${A}/commerce/web/buy/subscription`,buySubscriptionExit:`${A}/commerce/web/buy/subscription/{subscriptionId}/exit`,changeStoreFrontUrl:"itms-ui://finance-app.itunes.apple.com/account/manage-payments/change-storefront?isAccountSummary=true",managePaymentsUrl:`${_}account/manage-payments`,paymentsAndShippingUrl:`${_}account/manage-payments`,purchaseHistoryUrl:`${_}purchases`,"commerce-ui-urls":{"v2-url-patterns":["(?:/redeem|redeemLandingPage|freeProductCodeWizard|/account/add-funds|/account/billing|/account/subscriptions)","(?:54a1317a0ad442d3965d64ef6bfaae1c)([/?]|$)","WebObjects/MZFinance.woa/.*manageSubscriptions","WebObjects/MZFinance.woa/.*(useCommerceApp=true)","^https?://sandbox[.]itunes[.]apple[.]com/.*termsPage"]},"account-create-web":"https://activate.apple.com/account/create/personal"},H={"language-tag":"",inAppRefundReasons:`${L}/inApps/v1/refund/info/{transaction_id}`,inAppRefund:`${L}/inApps/v1/refund`};var G;!function(e){e[e.Array=0]="Array",e[e.Boolean=1]="Boolean",e[e.Double=2]="Double",e[e.Integer=3]="Integer",e[e.String=4]="String",e[e.Url=5]="Url",e[e.Dictionary=6]="Dictionary"}(G||(G={})),Object.entries(K).map((e=>[e[0],{value:e[1],type:G.Url}])),Object.entries($).map((e=>[e[0],{value:e[1],type:G.Boolean}])),Object.entries(H).map((e=>[e[0],{value:e[1],type:G.String}]));const Y=(e=b)=>((e,n={})=>{const{subdomain:t=b,buyReplacement:r=A,playReplacement:i=S,subsReplacement:o=x}=n,a=O(t),s=I(t),c=(e=>(e=>P("https://speedysub.{mediaDomain}.apple.com",e))(e||b))(t);return Object.entries(e).reduce(((e,[n,t])=>{const d="string"==typeof t?t.replace(r,a).replace(i,s).replace(o,c):t;return e[n]=d,e}),{})})({...K,...$,...H},{subdomain:e}),z=(e,n,t=!1)=>(...r)=>r.length>=n?t?e(...r.reverse()):e(...r):(...i)=>z(e,n,t)(...r,...i),J=(e,n=e.length)=>z(e,n,!0),q=(e,n=!1)=>{const t=new RegExp("([^?=&]+)(=([^&]*))","g");return(e.match(t)||[]).reduce(((e,t)=>{const r=t.split("="),i=r[0],o=r[1];return e[i]=n?decodeURIComponent(o):o,e}),{})},X=(e,n)=>{if(!e)return"";const t=e.includes("?");if("string"==typeof n&&""!==n){const r=n.includes("?");return t?r?`${e}&${n.substr(1)}`:`${e}&${n}`:r?`${e}${n}`:`${e}?${n}`}if(n instanceof Object&&!(n instanceof Array)&&0!==Object.entries(n).length){const r=Object.keys(n),i=new URLSearchParams(t?e.split("?")[1]:"");return r.forEach((e=>{null!==n[e]&&i.append(e,n[e])})),`${i}`.length>0&&!t?`${e}?${i}`:`${e}${i}`}return e};var Q,ee;(ee=Q||(Q={})).Music="music",ee.Tv="tv",ee.AppStore="apps",ee.PodcastsConnect="podcastcreators",ee.SeasonalTV="seasonaltv",ee.SeasonSubscription="seasonsubscription",ee.PodcastsConnectDeprecated="xyzw",ee.Activate="activate",ee.Car="car";const ne="podcastsconnect",te=["activate","tv","music",ne,"apps"],re=new RegExp(`^https:\\/\\/(?:${["cp","carry","beta","nightly","itms[0-9]+","itms[0-9]+-charts","dev"].join("|")})?[-.]??(${te.join("|")}).apple.com`,"i"),ie=/^https?:\/\/(?:.+\.)?(.+).apple.com/;let oe;const ae=(e={origin:location.origin,query:location.search,useCache:!0})=>{var n,t,r;const i=null!==(n=e.origin)&&void 0!==n?n:location.origin,o=null!==(t=e.query)&&void 0!==t?t:location.search;if((null===(r=e.useCache)||void 0===r||r)&&oe)return oe;let a="";const s=i.match(re),c=q(o),{product:d,returnPath:l}=c;if(d)a=d;else if(l&&decodeURIComponent(l).match(/product=/i)){const{product:e}=q(decodeURIComponent(l));a=e}else s&&(a=s[1]);return a=a.toLowerCase(),oe=a,a},se=()=>{var e;const n=null===(e=window.location.origin.match(ie))||void 0===e?void 0:e[1];return(null==n?void 0:n.endsWith(ne))?ne:n},ce=e=>re.test(e)||!1,de={[Q.Music]:"https://amp-account.music.apple.com",[Q.Tv]:"https://amp-account.tv.apple.com",[Q.PodcastsConnect]:"https://amp-account.podcasts.apple.com",[Q.PodcastsConnectDeprecated]:"https://amp-account.podcasts.apple.com"},le={link:"https://amp-account.tv.apple.com"},ue={accountCreateOptions:"{itunesBuyOrigin}/account/restricted/create/options",accountConversionInit:"{ampAccountDomain}/account/v1/web/convert/init",accountConversionSetSignedup:"{ampAccountDomain}/account/v1/web/convert/setSignedUp",accountPodSrv:"{itunesBuyOrigin}/account/pod",accountSettingsSrv:"{itunesBuyOrigin}/account/information/sections",acknowledgePrivacy:"{itunesBuyOrigin}/account/gdpr/acknowledgePrivacy",appAccessRequest:"{itunesBuyOrigin}/commerce/oauth2/internal/validate",auth:"{itunesBuyOrigin}/account/web/auth",authCwa:"https://auth.apps.apple.com/auth/v1/gs",ampTermsGetUrl:"https://amp-account.apps.apple.com/account/terms/info",ampTermsVerifyUrl:"https://amp-account.apps.apple.com/account/terms",buySubscription:"{itunesBuyOrigin}/commerce/web/buy/subscription",carrierLinkSrv:"{itunesBuyOrigin}/WebObjects/MZFinance.woa/wa/carrierLinkSrv",createAccountFieldsSrv:"{itunesPlayOrigin}/WebObjects/MZPlay.woa/wa/createAccountFieldsSrv",getChannelSubscriptionOfferParameters:"https://speedysub.itunes.apple.com/subscription/v1/channel/parameters",createAccountSrv:"{itunesBuyOrigin}/WebObjects/MZFinance.woa/wa/createAccountSrv",deviceLinkValidate:"{ampAccountDomain}/account/device-link/validate",editBillingInfoSrv:"{itunesBuyOrigin}/account/v1/nonstackable/paymentInfos/edit",generateAndSendSecCodeSrv:"{itunesBuyOrigin}/WebObjects/MZFinance.woa/wa/generateAndSendSecCodeSrv",generateEmailConfirmationCodeSrv:"{itunesBuyOrigin}/WebObjects/MZFinance.woa/wa/generateEmailConfirmationCodeSrv",getPayPalUrl:"{itunesBuyOrigin}/WebObjects/MZFinance.woa/wa/getPayPalUrl",getTermsByCountryAndTypeSrv:"{itunesBuyOrigin}/WebObjects/MZFinance.woa/wa/getTermsByCountryAndTypeSrv",idVerificationFieldsSrv:"{itunesBuyOrigin}/account/idverification/fields",initiateIdVerification:"{itunesBuyOrigin}/account/idverification/initiate",logout:"{itunesBuyOrigin}/account/web/logout",logoutAll:"{itunesBuyOrigin}/account/web/logout/all",nuDataSyncResponseSrv:"{itunesBuyOrigin}/WebObjects/MZFinance.woa/wa/nuDataSyncResponseSrv",parentalControlsDisable:"{ampAccountDomain}/account/parentalControls/disable",parentalControlsEdit:"{ampAccountDomain}/account/parentalControls/settings/edit",parentalControlsPinEdit:"{ampAccountDomain}/account/parentalControls/pin/edit",parentalControlsPinVerify:"{ampAccountDomain}/account/parentalControls/pin/verify",parentalControlsVideo:"https://amp-api.videos.apple.com/v1/storefronts/{alpha2Storefront}?include=rating-systems",parentalControlsMusic:"https://amp-api.music.apple.com/v1/storefronts/{alpha2Storefront}",parentalControlsRecoveryEmailEdit:"{ampAccountDomain}/account/parentalControls/recoveryEmail/edit",parentalControlsRecoveryEmailSend:"{ampAccountDomain}/account/parentalControls/recoveryEmail/send",parentalControlsSetup:"{ampAccountDomain}/account/parentalControls/setUp",paymentOptionsSrv:"{itunesBuyOrigin}/account/paymentOptions",redeemCodeInfo:"{itunesBuyOrigin}/commerce/web/redeemInfo",redeemSubscription:"{itunesBuyOrigin}/commerce/web/redeem/subscription",reInitiateIdVerification:"{itunesBuyOrigin}/account/idverification/reinitiate",sendCarmOtp:"{itunesBuyOrigin}/WebObjects/MZFinance.woa/wa/sendCarmOtp",carrierBillingOtpInitiate:"{itunesBuyOrigin}/payment/carrierbilling/otp/initiate",carrierBillingOtpReinitiate:"{itunesBuyOrigin}/payment/carrierbilling/otp/reinitiate",carrierBillingValidateOtp:"{itunesBuyOrigin}/payment/carrierbilling/otp/validate",carrierChannelLinkSrv:"{itunesBuyOrigin}/commerce/web/channel/link",carrierChannelSendSmsSrv:"{itunesBuyOrigin}/commerce/web/channel/send-sms-code",carrierChannelVerifySmsSrv:"{itunesBuyOrigin}/commerce/web/channel/verify-sms-code",subscriptionConfirmation:"{itunesBuyLiteOrigin}/web/buy/subscriptionConfirmationDialog",subscriptionOffers:"{itunesBuyOrigin}/commerce/web/subscription/offers/",subscriptionStatus:"{itunesBuyOrigin}/commerce/web/subscription/status/",subscriptionsSrv:"{itunesBuyOrigin}/commerce/web/subscription",termsAndConditions:"https://www.apple.com/legal/internet-services/itunes/",termsCheckSrv:"{itunesBuyOrigin}/account/terms",thirdPartyLogin:"{itunesBuyOrigin}/commerce/oauth2/internal/authorization",tvAgeVerifyPayment:"{itunesBuyOrigin}/account/verifyPayment",validateAccountFieldsSrv:"{itunesBuyOrigin}/WebObjects/MZFinance.woa/wa/validateAccountFieldsSrv",validateCarm:"{itunesBuyOrigin}/WebObjects/MZFinance.woa/wa/validateCarm",validateEmailConfirmationCodeSrv:"{itunesBuyOrigin}/WebObjects/MZFinance.woa/wa/validateEmailConfirmationCodeSrv",validateSecCodeSrv:"{itunesBuyOrigin}/WebObjects/MZFinance.woa/wa/validateSecCodeSrv",verifyIdVerification:"{itunesBuyOrigin}/account/idverification/verify",paymentChallengeInitiate:"{itunesBuyOrigin}/account/challenge/initiate",paymentChallengeVerify:"{itunesBuyOrigin}/account/challenge/verify",watchListSettings:"{itunesBuyOrigin}/account/v1/watchList/settings",webAccountInfo:"{itunesBuyOrigin}/account/web/info",webAccountInfoRefresh:"{itunesBuyOrigin}/account/web/infoRefresh",qrAuthValidate:"{itunesAuthOrigin}/auth/v1/qr/validate",qrAuthLink:"{itunesAuthOrigin}/auth/v1/qr/link",qrAuthRoute:"{itunesAuthOrigin}/auth/v1/qr/route",registerDeviceFpdi:"{itunesBuyOrigin}/commerce/account/subscription/offers/device",idmsSignin:"https://idmsa.apple.com/IDMSWebAuth/signin",idmsSigninUAT:"https://idmsa-uat.apple.com/IDMSWebAuth/signin"},pe={};let me,he={},fe=e=>he[e];const ge=(e,n=ae(),t=se())=>{const r=le[t||""]||de[n]||de[Q.Music];return e.replace("{ampAccountDomain}",r)},ye=(e,n)=>n?e.replace("{alpha2Storefront}",(e=>{return(n=f,Object.keys(n)).find((n=>f[n]===e))||"US";var n})(n).toLowerCase()):e,ve=e=>{return e.replace("{itunesBuyOrigin}",O(me)).replace("{itunesPlayOrigin}",I(me)).replace("{itunesAuthOrigin}",(n=me,(e=>P("https://auth.{mediaDomain}.apple.com",e))(n||b))).replace("{itunesBuyLiteOrigin}",(e=>(e=>P("https://buylite.{mediaDomain}.apple.com",e))(e||b))(me)).replace(".link.apple.com",".tv.apple.com");var n},Ce=(e={})=>{me=se(),"activate"===me&&(me=null),e.getBagValueOverride&&(fe=e.getBagValueOverride),he={...Y(me||""),...ue,...pe}},be=(e,{productContext:n=ae(),subdomain:t=se(),storefront:r}={})=>{const i=fe(e),o=void 0!==i?i:ue[e];return"string"==typeof o?((e,{storefront:n,productContext:t,subdomain:r}={})=>((...e)=>n=>e.reduce(((e,n)=>n(e)),n))(ve,J(ge,3)(r,t),J(ye)(n))(e))(o,{productContext:n,storefront:r,subdomain:t}):o},Ae=({webAuthUrl:e,webLogoutUrl:n,webLogoutAllUrl:t})=>{const r=Se();he.auth=null==e?void 0:e.replace(b,r),he.logout=null==n?void 0:n.replace(b,r),he.logoutAll=null==t?void 0:t.replace(b,r)},Se=()=>me||b;function xe(e){return e&&(-1===e.status||e.errorMessage||e.errorMessageKey)}var Me,Pe;(Pe=Me||(Me={})).Json="application/json",Pe.FormUrlEncoded="application/x-www-form-urlencoded";class Ie extends Error{constructor(e,n={}){super(),this.name="SERVER_ERROR";const{url:t,status:r,body:i,domain:o,errorType:a,errorMessageKey:s,details:c}=n;if(t?(this.url=(e=>{const n=new URL(e);return`${n.origin}/${n.pathname}`})(t),this.message=`${e}: ${this.url}`):this.message=e,r&&(this.status=parseInt(r.toString(),10)),this.body=i,this.domain=o,this.errorType=a,this.details=c,s)this.errorMessageKey=s;else{const{errorMessageKey:e}=(null==c?void 0:c.AMSServerPayload)||{},{errorMessageKey:n}=i||{};this.errorMessageKey=e||n}}get code(){return this.status}}Error,Error,Error;const Oe=class extends Error{constructor(e,n){super(),this.name="UNSUPPORTED_VALUE",this.message=`Unsupported value for '${e}': ${n}`}},je=(Error,class extends Error{constructor(){super("The server is taking too long to respond")}}),we=e=>e instanceof Ie,Le=2,Ee=async(e,n,t={},r={})=>{const{account:i,authHandler:o,handleAuthError:a,interceptors:s={},interceptorOptions:c,onFinishedCallback:d,shouldRetryOn401:l=!0}=t,{maxRetries:u=Le,retries:p=0,backOffInMs:m=200,timeoutInMs:h}=r;try{const r=n(e,t);let i;i=h?await function(e,n,t){return Promise.race([e,new Promise(((e,r)=>setTimeout(r,n,new t)))])}(r,h,je):await r;const{status:o,body:a}=i,l=o?s[o]:null;if(l&&!t.shouldDisableInterceptors)try{await l(i,o?null==c?void 0:c[o]:void 0)}catch(e){console.error(`${o} interceptor failed`,e)}if(o&&o>=400){let n;throw n=xe(a)?{errorMessage:a.errorMessage,status:a.status,errorMessageKey:a.errorMessageKey}:a,new Ie("makeHttpRequest",{url:e,status:o,body:n})}return i}catch(s){const c=(e=>{if(we(e))return e;const n="Server Error";if((e=>"userinfo"in e)(e)){const{userinfo:t,code:r,title:i,message:o}=e;return new Ie(i||o||n,{status:t.AMSServerErrorCode||t.AMSStatusCode||r,details:t})}if((e=>"errorMessageKey"in e||"errorType"in e)(e)){const{status:t,errorType:r,errorMessageKey:i}=e;return new Ie(n,{status:t,errorType:r,errorMessageKey:i})}const{code:t,localizedDescription:r}=e;return t?new Ie(r||n,{status:t}):void 0})(s);if(!c)throw s;if((e=>{if(!we(e))return!1;const{code:n,errorType:t,errorMessageKey:r}=e;return 401===n||"Authentication"===t||"MZCommerce.NoAuthorization"===r})(c)){if(a&&o&&await o(i),l)return Ee(e,n,{...t,shouldRetryOn401:!1},r);throw c}if(p>=u)throw c;return await(f=m,new Promise((e=>setTimeout(e,f)))),Ee(e,n,t,{...r,retries:p+1,backOffInMs:2*m})}finally{d&&d()}var f};var De;!function(e){e[e.Success=200]="Success",e[e.BadRequest=400]="BadRequest",e[e.NotFound=404]="NotFound",e[e.ServerError=500]="ServerError",e[e.NotImplemented=501]="NotImplemented"}(De||(De={}));const Ne=(e,n)=>{return"string"==typeof e?e:n===Me.FormUrlEncoded?(t=e,Object.entries(t).map((([e,n])=>{const t=(e=>/string|number|boolean/.test(typeof e))(n)?encodeURIComponent(n):`${n}`;return`${encodeURIComponent(e)}=${t}`})).filter(Boolean).join("&")):JSON.stringify(e);var t},Te=(e,n)=>(async(e,n={onFinishedCallback:()=>{}})=>{const{fetchOptions:t,body:r,contentType:i,method:o,headers:a}=n,s={body:r?Ne(r,i):void 0,headers:a,method:o,...t},c=await fetch(e,s),{status:d}=c,l=await(async e=>{const{status:n,headers:t}=e,r=t.get("Content-Type")||"";if(202!==n&&204!==n&&(200!==n||r)){if(r.match(/^application\/json/))try{return await e.json()}catch(t){throw new Ie("handleResponseBody",{url:e.url,status:n})}throw new Ie("handleResponseBody",{url:e.url,status:n,body:{errorMessage:`Response contentType was unexpected: ${r}.`,errorMessageKey:"contentType"}})}})(c);return{body:l,status:d}})(e,n),Re={af:48,sq:1,ar:34,eu:1,bg:49,be:1,ca:42,zh:19,"zh-tw":18,"zh-cn":19,"zh-hk":45,"zh-sg":19,hr:41,cs:22,da:11,nl:10,"nl-be":65,en:1,"en-us":1,"en-eg":26,"en-au":27,"en-gb":2,"en-ca":6,"en-nz":27,"en-ie":26,"en-za":26,"en-jm":26,"en-bz":26,"en-tt":26,"en-001":26,et:30,fo:1,fa:59,fi:12,fr:3,"fr-ca":5,gd:2,de:4,"de-ch":57,el:23,he:36,hi:50,hu:21,is:31,id:37,it:7,ja:9,ko:13,lv:33,lt:32,mk:1,mt:1,no:14,nb:14,nn:14,pl:20,"pt-br":15,pt:24,rm:1,ro:39,ru:16,sr:1,sk:40,sl:52,es:8,"es-mx":28,"es-419":44,sv:17,th:35,ts:1,tn:1,tr:25,uk:29,ur:55,ve:1,vi:43,xh:1,yi:1,zu:56,ms:38,iw:36,lo:46,tl:47,kk:51,ta:53,te:54,bn:58,ga:60,ht:61,la:62,pa:63,sa:64},Ue={ALB:{supportedLanguages:["en-gb"],copyrightKey:"CopyrightApple.Europe"},ARE:{supportedLanguages:["en-gb","ar-sa"]},ARG:{supportedLanguages:["es-mx","en-gb"]},AUS:{supportedLanguages:["en-au","en-gb"]},AUT:{supportedLanguages:["de-de","en-gb"],copyrightKey:"CopyrightApple.Europe"},BEL:{supportedLanguages:["en-gb","fr-fr","nl-nl"],copyrightKey:"CopyrightApple.Europe"},BEN:{supportedLanguages:["en-gb","fr-fr"]},BFA:{supportedLanguages:["en-gb","fr-fr"]},BHR:{supportedLanguages:["en-gb","ar-sa"]},BIH:{supportedLanguages:["en-gb","hr-hr"]},BLZ:{supportedLanguages:["en-gb","es-mx"]},BOL:{supportedLanguages:["es-mx","en-gb"]},BRA:{supportedLanguages:["pt-br","en-gb"]},CAF:{supportedLanguages:["fr-fr","en-gb"]},CAN:{supportedLanguages:["en-ca","fr-ca"]},CHE:{supportedLanguages:["de-ch","de-de","en-gb","fr-fr","it-it"],copyrightKey:"CopyrightApple.Europe"},CHL:{supportedLanguages:["es-mx","en-gb"]},CHN:{supportedLanguages:["zh-cn","en-gb"],copyrightKey:"CopyrightApple.CHN"},CIV:{supportedLanguages:["fr-fr","en-gb"]},CMR:{supportedLanguages:["fr-fr","en-gb"]},COD:{supportedLanguages:["en-gb","fr-fr"]},COG:{supportedLanguages:["en-gb","fr-fr"]},COL:{supportedLanguages:["es-mx","en-gb"]},CRI:{supportedLanguages:["es-mx","en-gb"]},CYP:{supportedLanguages:["en-gb","el-gr","tr-tr"],copyrightKey:"CopyrightApple.Europe"},CZE:{supportedLanguages:["en-gb","cs-cz"],copyrightKey:"CopyrightApple.Europe"},DEU:{supportedLanguages:["de-de","en-gb"],copyrightKey:"CopyrightApple.Europe"},DNK:{supportedLanguages:["en-gb","da-dk"],copyrightKey:"CopyrightApple.Europe"},DOM:{supportedLanguages:["es-mx","en-gb"]},DZA:{supportedLanguages:["en-gb","fr-fr","ar-sa"]},ECU:{supportedLanguages:["es-mx","en-gb"]},EGY:{supportedLanguages:["en-gb","fr-fr","ar-sa"]},ESP:{supportedLanguages:["es-es","en-gb","ca-es"],copyrightKey:"CopyrightApple.Europe"},EST:{supportedLanguages:["en-gb"],copyrightKey:"CopyrightApple.Europe"},FIN:{supportedLanguages:["en-gb","fi-fi"],copyrightKey:"CopyrightApple.Europe"},FRA:{supportedLanguages:["fr-fr","en-gb"],copyrightKey:"CopyrightApple.Europe"},GAB:{supportedLanguages:["fr-fr","en-gb"]},GBR:{supportedLanguages:["en-gb"],copyrightKey:"CopyrightApple.Europe"},GIN:{supportedLanguages:["fr-fr","en-gb"]},GNB:{supportedLanguages:["en-gb","fr-fr"]},GRC:{supportedLanguages:["en-gb","el-gr"],copyrightKey:"CopyrightApple.Europe"},GTM:{supportedLanguages:["es-mx","en-gb"]},GUY:{supportedLanguages:["en-gb","fr-fr"]},HKG:{supportedLanguages:["zh-hk","en-gb","zh-tw"]},HND:{supportedLanguages:["es-mx","en-gb"]},HRV:{supportedLanguages:["en-gb","hr-hr"],copyrightKey:"CopyrightApple.HRV"},HUN:{supportedLanguages:["en-gb","hu-hu"],copyrightKey:"CopyrightApple.Europe"},IDN:{supportedLanguages:["en-gb","id-id"]},IND:{supportedLanguages:["en-gb","hi-in"]},IRL:{supportedLanguages:["en-gb"],copyrightKey:"CopyrightApple.Europe"},IRQ:{supportedLanguages:["en-gb","ar-sa"]},ISL:{supportedLanguages:["en-gb"],copyrightKey:"CopyrightApple.ISL"},ISR:{supportedLanguages:["en-gb","iw-il"]},ITA:{supportedLanguages:["it-it","en-gb"],copyrightKey:"CopyrightApple.Europe"},JOR:{supportedLanguages:["en-gb","ar-sa"]},JPN:{supportedLanguages:["ja-jp","en-us"],copyrightKey:"CopyrightApple.JPN"},KHM:{supportedLanguages:["en-gb","fr-fr"]},KOR:{supportedLanguages:["ko-kr","en-gb"],copyrightKey:"CopyrightApple.KOR"},KWT:{supportedLanguages:["en-gb","ar-sa"]},LAO:{supportedLanguages:["en-gb","fr-fr"]},LBN:{supportedLanguages:["en-gb","fr-fr","ar-sa"]},LBY:{supportedLanguages:["en-gb","ar-sa"]},LTU:{supportedLanguages:["en-gb"],copyrightKey:"CopyrightApple.Europe"},LUX:{supportedLanguages:["en-gb","fr-fr","de-de"],copyrightKey:"CopyrightApple.Europe"},LVA:{supportedLanguages:["en-gb"],copyrightKey:"CopyrightApple.Europe"},MAC:{supportedLanguages:["zh-hk","en-gb","zh-tw"]},MAR:{supportedLanguages:["en-gb","fr-fr","ar-sa"]},MCO:{supportedLanguages:["fr-fr","en-gb"]},MDG:{supportedLanguages:["en-gb","fr-fr"]},MEX:{supportedLanguages:["es-mx","en-gb"]},MLI:{supportedLanguages:["en-gb","fr-fr"]},MLT:{supportedLanguages:["en-gb"],copyrightKey:"CopyrightApple.Europe"},MNE:{supportedLanguages:["en-gb","hr-hr"]},MRT:{supportedLanguages:["en-gb","fr-fr","ar-sa"]},MUS:{supportedLanguages:["en-gb","fr-fr"]},MYS:{supportedLanguages:["en-gb","ms-my"]},NER:{supportedLanguages:["en-gb","fr-fr"]},NIC:{supportedLanguages:["es-mx","en-gb"]},NLD:{supportedLanguages:["nl-nl","en-gb"],copyrightKey:"CopyrightApple.Europe"},NOR:{supportedLanguages:["en-gb","no-no"],copyrightKey:"CopyrightApple.Europe"},NZL:{supportedLanguages:["en-au","en-gb"]},OMN:{supportedLanguages:["en-gb","ar-sa"]},PAN:{supportedLanguages:["es-mx","en-gb"]},PER:{supportedLanguages:["es-mx","en-gb"]},POL:{supportedLanguages:["en-gb","pl-pl"],copyrightKey:"CopyrightApple.Europe"},PRT:{supportedLanguages:["pt-pt","en-gb"],copyrightKey:"CopyrightApple.Europe"},PRY:{supportedLanguages:["es-mx","en-gb"]},QAT:{supportedLanguages:["en-gb","ar-sa"]},ROU:{supportedLanguages:["en-gb","ro-ro"],copyrightKey:"CopyrightApple.Europe"},RUS:{supportedLanguages:["ru-ru","en-gb","uk-ua"],copyrightKey:"CopyrightApple.Europe"},RWA:{supportedLanguages:["en-gb","fr-fr"]},SAU:{supportedLanguages:["en-gb","ar-sa"]},SEN:{supportedLanguages:["en-gb","fr-fr"]},SGP:{supportedLanguages:["en-gb","zh-cn"]},SLV:{supportedLanguages:["es-mx","en-gb"]},SRB:{supportedLanguages:["en-gb","hr-hr"]},SUR:{supportedLanguages:["en-gb","nl-nl"]},SVK:{supportedLanguages:["en-gb","sk-sk"],copyrightKey:"CopyrightApple.Europe"},SVN:{supportedLanguages:["en-gb"],copyrightKey:"CopyrightApple.Europe"},SWE:{supportedLanguages:["sv-se","en-gb"],copyrightKey:"CopyrightApple.Europe"},SYC:{supportedLanguages:["en-gb","fr-fr"]},TCD:{supportedLanguages:["en-gb","fr-fr"]},THA:{supportedLanguages:["en-gb","th-th"]},TTO:{supportedLanguages:["en-gb","fr-fr"]},TUN:{supportedLanguages:["en-gb","fr-fr","ar-sa"]},TUR:{supportedLanguages:["en-gb","tr-tr"]},TWN:{supportedLanguages:["zh-tw","en-gb"]},UKR:{supportedLanguages:["en-gb","uk-ua","ru-ru"]},URY:{supportedLanguages:["en-gb","es-mx"]},USA:{supportedLanguages:["en-us","es-mx","zh-cn","ar-sa","ru-ru","fr-fr","pt-br","vi-vi","ko-kr","zh-tw"]},VEN:{supportedLanguages:["es-mx","en-gb"]},VNM:{supportedLanguages:["en-gb","vi-vi"]},VUT:{supportedLanguages:["en-gb","fr-fr"]},YEM:{supportedLanguages:["en-gb","ar-sa"]},ZAF:{supportedLanguages:["en-gb"],copyrightKey:"CopyrightApple.ZAF"}};var ke;ke=j,Object.entries(ke).reduce(((e,n)=>{const[t,r]=n;return"string"==typeof r||"number"==typeof r||"symbol"==typeof r?{...e,[r]:t}:e}),{});const Fe={};let Be=()=>{},We="USA",Ve="en-us",_e=!1;const Ze=e=>{const n=new Headers,t=We,r=j[t]?((e="en-us")=>{const n=e.toLowerCase(),t=Re[n];if(t)return t;if(e.includes("-")){const n=e.split("-")[0].toLowerCase(),t=Re[n];if(t)return t}return Re["en-us"]})(Ve):"1",i=j[t]||j.USA;return n.set("X-Apple-Store-Front",`${i}-${r},8`),n.set("Accept-Language",Ve||"en-us"),n.set("Content-Type",Me.Json),e instanceof Headers?e.forEach(((e,t)=>{n.set(t,e)})):"object"==typeof e&&Object.entries(e).forEach((([e,t])=>{n.set(e,t)})),n},$e=(e,n)=>{Fe[e]=n},Ke=async(e,n={})=>{const{shouldRetryOn401:t,headers:r,body:i,method:o,interceptorOptions:a,shouldDisableInterceptors:s,...c}=n;return(await(async(e,n,t={},r={})=>{const{queryParams:i,body:o,forceQueryParams:a=!1}=t,s=!i||!a&&o?e:y(e,i);return Ee(s,n,t,r)})(e,Te,{onFinishedCallback:Be,shouldRetryOn401:t||_e,interceptors:Fe,headers:Ze(r),body:i,interceptorOptions:a,shouldDisableInterceptors:s,method:o,fetchOptions:{credentials:"include",...c}},{maxRetries:0})).body},He=async()=>Ke(((e=ae())=>ge("{ampAccountDomain}/account/web/config",e))());var Ge=t(5603),Ye=t(2851),ze=t(369);const Je=e=>(e=>2===e.length&&/[a-z]{2}/i.test(e))(e)||(e=>3===e.length&&/[0-9]{3}/.test(e))(e),qe=["ar","he","iw"],Xe=e=>qe.includes(e),Qe=e=>{const[n]=(e||"").split("-");if(2!==n.length&&3!==n.length||!/[a-z]/i.test(n))return null;const t=n.toLowerCase(),r=(e=>{const[,n=""]=e.split("-");return 3===n.length&&/[a-z]{3}/i.test(n)?n.toLowerCase():""})(e),i=(e=>{const[,n="",t=""]=e.split("-");let r="";if(4===n.length?r=n:4===t.length&&(r=t),!r)return r;const i=r.split("");return i[0]=i[0].toUpperCase(),i.join("")})(e),o=(e=>{const[,n="",t="",r=""]=e.split("-");let i="";return Je(n)?i=n:Je(t)?i=t:Je(r)&&(i=r),i.toUpperCase()})(e);return{languageTag:[t,r,i,o].filter(Boolean).join("-"),languageCode:t,extlang:r,script:i,region:o,direction:Xe(n)?"rtl":"ltr",get isRtlLanguage(){return"rtl"===this.direction},get isLtrLanguage(){return"ltr"===this.direction}}},en=["en","id","mk"],nn=["da","cs","de","es","ca","fi","fr","hu","hr","it","no","pl","pt","ro","sk","sv","tr","vi","nl"],tn=["ko","zh","yue"],rn=["ar","el","he","ja","ru","th","uk","hi"],on=ze;let an="",sn=!1,cn={},dn="",ln=!1,un=!1;Q.Tv,Q.Music;let pn=m((async()=>{if(dn&&!sn){const e=await fetch(`${dn}/default-localizations.json`),n=await e.json();return sn=!0,n}}));const mn={},hn=(e,n={showScreamers:!1})=>{const{defaultLocalizations:t,importDefaultLocalizations:r,showScreamers:i,showUnlocalizedUi:o}=n;dn=e,"object"==typeof t&&t&&(pn=()=>Promise.resolve(void 0),cn=t),"function"==typeof r&&(pn=r),"boolean"==typeof i&&(ln=i),"boolean"==typeof o&&(un=o)};let fn,gn="";const yn=async(e="en-us")=>{if(!dn)return{};const n=`${dn}/${e}.json`;return(await fetch(n)).json()},vn=e=>(async(e="en-us")=>{if(!e)throw new Error("loadLocalizations: did not receive newLanguage");const n=e.toLowerCase(),[t,r]=await Promise.allSettled([yn(n),pn()]);if("fulfilled"===t.status?mn[n]=t.value:console.error(`Failed to load localizations for ${n}`),"fulfilled"===r.status){const e=Array.isArray(r.value)?r.value:[r.value];cn=e.reduce(((e,n)=>({...e,...n})),{})}else console.error("Failed to load default localizations");an=n})(e).finally((()=>{gn="",fn=Promise.resolve()})),Cn=async(e="en-us")=>{if(!e)throw new Error("loadLocalizationsIfNeeded: did not receive newLanguage");const n=e.toLowerCase();if(!mn[n])return gn||(gn=n,fn=vn(n)),gn!==n&&fn&&(gn=n,fn=fn.finally((()=>(gn=n,vn(n))))),fn;an=n},bn=/@@([^@]+)@@/g,An=/(@@[^@]+@@)/g,Sn=/^\*\*.+\*\*$/,xn=e=>{const n=mn[an]||{},t=n[e],r=e in n&&(i=t,!Sn.test(i));var i;return un?r?e:`**${e}**`:r?t:e in cn?cn[e]:ln?`**${e}**`:""},Mn=(e,n={})=>((e,n={})=>"string"!=typeof e?"":e.replace(bn,((e,t)=>n[t]||t)))(xn(e),n);function Pn(e,n){n.error,n.componentStack,e.readyToBeShown();var t=[(0,a.jsx)("div",{className:"error-boundary__description",children:Mn("CommerceUI.CWA.GeneralError.Description")},"userError")];return(0,a.jsx)(Ye.$0,{children:(0,a.jsx)(Ye.M$,{children:(0,a.jsx)(Ye.Zb,{theme:"banner",shadow:!1,title:(0,a.jsx)(Ye.Bc,{inline:!0,solid:!1,children:Mn("CommerceUI.CWA.GeneralError.Title")},void 0),lines:t},void 0)},void 0)},void 0)}class In extends Error{constructor(e){super(`[MetricsServiceError] ${e}`),this.name="MetricsServiceError"}}let On;const jn=e=>{if(On)throw new In("You can only set the config a single time");On=Object.freeze(e)};t(685),t(1419);const wn={main:{},funnel:{}},Ln=(e=!1)=>{const n=Object.values(wn)[0],t=n&&Object.values(n)[0];null==t||t.system.eventRecorder.flushUnreportedEvents(e)};var En,Dn,Nn,Tn,Rn,Un,kn,Fn;t(2227),function(e){e.AppStore="MacAppStore",e.Books="iBooks",e.CommerceApp="commerce-app",e.Fitness="Fitness",e.IcloudSettings="iCloudSettings",e.Itunes="iTunes",e.ItunesU="iTunesU",e.Music="Music",e.News="News",e.Podcasts="Podcasts",e.SetupAssistant="Assistant",e.Tv="TV"}(En||(En={})),function(e){e.AppStore="AppStore",e.Books="Books",e.CommerceApp="CommerceApp",e.Fitness="Fitness",e.IcloudSettings="IcloudSettings",e.Itunes="Itunes",e.ItunesU="ItunesU",e.Music="Music",e.News="News",e.Podcasts="Podcasts",e.SetupAssistant="SetupAssistant",e.Settings="Settings",e.Tv="Tv"}(Dn||(Dn={})),function(e){e.Music="xp_amp_music_perf",e.Subscriptions="xp_amp_subscriptions_cs_perf",e.Test="itsmetrics_test"}(Nn||(Nn={})),function(e){e.AppStore="xp_amp_appstore",e.AppStoreUnidentified="xp_amp_appstore_unidentified",e.Main="xp_its_main",e.MusicMain="xp_its_music_main",e.MusicUnidentified="xp_amp_music_cs_unidentified",e.MusicWebplayer="xp_amp_music_webplayer",e.CommercePh="xp_amp_commerce_ph",e.Payments="xp_amp_payments",e.Redeem="xp_amp_redeem",e.Subscriptions="xp_amp_subscriptions_cs",e.TvMain="xp_amp_tv_main",e.TvUnidentified="xp_amp_tv_unidentified"}(Tn||(Tn={})),function(e){e.Ok="Ok",e.Continue="Continue",e.Cancel="cancel",e.Confirm="Cancel",e.LearnMore="learnMore",e.NotNow="NotNow",e.DefaultPayment="defaultPayment",e.Remove="Remove",e.Delete="Delete"}(Rn||(Rn={})),function(e){e.Click="click",e.Ok="Ok"}(Un||(Un={})),function(e){e.Buy="Buy",e.Cancel="Cancel",e.Error="Error",e.OkCancel="okCancel",e.Success="Success"}(kn||(kn={})),function(e){e.Web="AMPWeb",e.Funnel="AMPFunnel"}(Fn||(Fn={}));const Bn="commerce-app";var Wn,Vn,_n,Zn;let $n;!function(e){e.Add="Add",e.AddPaymentMethod="addPaymentMethod",e.Back="Back",e.Cancel="Cancel",e.Dismiss="Dismiss",e.Done="Done",e.EditPaymentMethod="editPaymentMethod",e.FoundInWallet="FoundInWalletCard",e.FoundInWalletAuth="foundInAPWalletAuth",e.LearnMore="LearnMore",e.Next="next",e.NotNow="NotNow",e.Ok="Ok",e.RemovePaymentText="RemovePmtText",e.ReorderPaymentIcon="ReorderPmtIcon",e.ResendCode="ResendCode",e.ReviewSubscription="ReviewSubscription",e.TermsAndConditions="termsAndConditions",e.UpdatePaymentType="updatePaymentType",e.UpgradeCard="UpgradeCard",e.Verify="Verify"}(Wn||(Wn={})),function(e){e.Add="ADD",e.Back="back",e.Buy="buy",e.BuyInitiate="buyInitiate",e.Cancel="cancel",e.Dismiss="dismiss",e.Done="Done",e.Edit="EDIT",e.Focus="focus",e.Move="move",e.Navigate="navigate",e.Open="open",e.Request="request",e.Select="select",e.Submit="submit",e.Synthetic="synthetic",e.Update="update"}(Vn||(Vn={})),function(e){e.Button="button",e.Input="input",e.Link="link",e.Reason="reason",e.SelectOption="select_option",e.Switch="switch"}(_n||(_n={})),function(e){e.Modal="Modal"}(Zn||(Zn={})),Vn.Navigate,_n.Button;const Kn=new Promise((e=>$n=e));let Hn;document.addEventListener("visibilitychange",(()=>{"hidden"===document.visibilityState&&Ln(!0)}));const Gn=e=>{Hn=e};var Yn;!function(e){e.CanBuyVppLicenses="UnsupportedAccountTypeForWeb_CanBuyVppLicenses",e.CanManageVppLicenses="UnsupportedAccountTypeForWeb_CanManageVppLicenses",e.CanShopInVolumeEducationStore="UnsupportedAccountTypeForWeb_CanShopInVolumeEducationStore",e.CanShopInVolumeEnterpriseStore="UnsupportedAccountTypeForWeb_CanShopInVolumeEnterpriseStore",e.ConversionRequired="UnsupportedAccountTypeForWeb_ConversionRequired",e.IsManagedAppleId="UnsupportedAccountTypeForWeb_IsManagedAppleId",e.IsSpecialEduAccount="UnsupportedAccountTypeForWeb_IsSpecialEduAccount",e.NoAccountFound="NoAccountFound",e.LiteAccount="UnsupportedAccountTypeForWeb_LiteAccount",e.IneligibleStorefront="IneligibleStoreFront"}(Yn||(Yn={}));const zn=m((async()=>Ke(be("authCwa"),{method:"POST",shouldDisableInterceptors:!0})));var Jn;function qn(){var e=(0,l.TH)().state||{},n=e.errorType,t=e.reason,r="",i="";return n===Jn.Auth?(r=Mn("CommerceUI.CWA.Authentication.Error.Title"),i=(e=>{switch(e){case Yn.CanBuyVppLicenses:case Yn.CanManageVppLicenses:case Yn.CanShopInVolumeEducationStore:case Yn.CanShopInVolumeEnterpriseStore:case Yn.IsManagedAppleId:case Yn.IsSpecialEduAccount:return Mn("CommerceUI.CWA.Authentication.Error.Description.UnsupportedAccountType");case Yn.NoAccountFound:case Yn.LiteAccount:case Yn.ConversionRequired:return Mn("CommerceUI.CWA.Authentication.Error.Description.AccountNeedsConversion");case Yn.IneligibleStorefront:return Mn("CommerceUI.CWA.Authentication.Error.Description.IneligibleStorefront");default:return Mn("CommerceUI.CWA.Authentication.Error.Description")}})(t)):(r=Mn("CommerceUI.CWA.GeneralError.Title"),i=Mn("CommerceUI.CWA.GeneralError.Description")),(0,a.jsx)(Ye.$0,{children:(0,a.jsx)(Ye.M$,{children:(0,a.jsx)(Ye.Zb,{theme:"banner",shadow:!1,title:(0,a.jsx)(Ye.Bc,{inline:!0,solid:!1,children:r},void 0),lines:[(0,a.jsx)("div",{children:i},"1")]},void 0)},void 0)},void 0)}!function(e){e.Auth="auth"}(Jn||(Jn={}));const Xn="/payments",Qn="/payments/edit",et="/payments/add",nt="/error/module-load",tt="/external-linking",rt=()=>window.parent!==window,it=()=>rt()&&(document.referrer.includes("appleid")||document.location.search.includes("wid="));var ot,at,st=t(8170);(at=ot||(ot={}))[at.AmkClientWrapper=0]="AmkClientWrapper",at[at.StandaloneClient=1]="StandaloneClient",at[at.TestClient=2]="TestClient",at[at.CypressClient=3]="CypressClient",at[at.CommerceKitClient=4]="CommerceKitClient";const ct={idms2:"https://appleid-qa1.corp.apple.com",idms1:"https://appleid-ut.corp.apple.com",idms_stage:"https://appleid-stage.apple.com",idms_prod:"https://appleid.apple.com"};let dt;var lt=t(6427);const ut={"amp-edit-payment":lt.x4.EditPayment,"amp-payments":lt.x4.ManagePayments,"amp-add-payment":lt.x4.AddPayment,"amp-payments/shipping/edit":lt.x4.EditShipping},pt=class{constructor({initialHandler:e}={}){this.handlers=e?[e]:[]}subscribe(e){this.handlers.push(e)}unsubscribe(e){this.handlers=this.handlers.filter((n=>n!==e))}unsubscribeAll(){this.handlers=[]}notify(e){this.handlers.forEach((n=>n(e)))}hasHandlers(){return this.handlers.length>0}},mt="RESUME",ht=(e,n,t={})=>!!e&&!!ce(e.origin)&&(e.postMessage({"__ca-message":n,...t},e.origin),!0),ft=new Map;let gt=!1;const yt=e=>{var n;const{data:t,origin:r}=e;if(ce(r)){const e=t["__ca-message"];delete t["__ca-message"],null===(n=ft.get(e))||void 0===n||n.notify(t)}},vt=(e,n)=>{e&&n&&(gt||(window.addEventListener("message",yt),gt=!0),ft.has(e)?ft.get(e).subscribe(n):ft.set(e,new pt({initialHandler:n})))},Ct=(e,n)=>{if(e&&n&&ft.has(e)){const t=ft.get(e);t.unsubscribe(n),t.hasHandlers()||(ft.delete(e),0===ft.size&&(window.removeEventListener("message",yt),gt=!1))}};new pt;var bt,At,St={"amp-payments":Xn,"amp-edit-payment":Qn,"amp-add-payment":et,"amp-subscriptions":"/subscriptions","amp-subscriptions-device-cancel-fees":"/subscriptions/device/cancel/fees","amp-subscriptions-device-cancel-confirm":"/subscriptions/device/cancel/confirm","amp-subscriptions-device-cancel-return":"/subscriptions/device/cancel/return"};if(rt())if(it()){var xt=q(location.href).env;bt=((e="idms_prod",n)=>(dt=new st.DD(ct[e],{autoResize:null==n?void 0:n.autoResizeElement}),{name:ot.AmkClientWrapper,getConfiguration:g((()=>dt.configuration),500),deepLink:dt.deepLink,readyToBeShown:()=>dt.readyToBeShown(),onWillBeShown:dt.onWillBeShown,close:e=>dt.close(e),openModule:(e,n)=>dt.openModule(e,n),pushModule:(e,n)=>dt.pushModule(e,n),renewAuthTokens:()=>dt.renewAuthTokens(),continueOnDevice:(e,n)=>dt.continueOnDevice(e,n),emitMessage:(e,n,t={})=>dt.emitMessage(e,n,t),onMessage:(e,n)=>dt.onMessage(e,(({source:e,data:t})=>{n({source:e,data:t})})),popModule:e=>dt.popModule(e),navigateToSection:e=>dt.navigateToSection(e)}))((At=xt,Object.keys(ct).includes(At)?xt:void 0),{autoResizeElement:document.getElementById("root")||void 0})}else bt=(()=>{const e=(0,lt.Jz)();return{name:ot.CommerceKitClient,readyToBeShown(){e.send("parent",lt.B_.ReadyToBeShown)},onWillBeShown(){console.warn("CommerceKit Client: onWillBeShown not implemented")},close(n){e.closeModal(null==n?void 0:n.data)},openModule(n,t){const{path:r,params:i,data:o}=t||{},a=ut[`${n}${r||""}`];if(!a)throw new Error(`Could not find CommerceKit route for module name '${n}'`);return e.openModal(a,{queryParams:i,data:o})},pushModule(){console.warn("CommerceKit Client: pushModule not implemented")},popModule(){console.warn("CommerceKit Client: popModule not implemented")},renewAuthTokens:()=>Promise.reject(),continueOnDevice:()=>Promise.resolve(),getConfiguration(){const{data:n}=e.getBootConfig();return Promise.resolve({pushEligibility:{},data:n})},emitMessage(){console.warn("CommerceKit Client: emitMessage not implemented")},onMessage:()=>(console.warn("CommerceKit Client: onMessage not implemented"),()=>!1)}})();else bt=((e,n={})=>{const t={search:document.location.search,searchParams:new URLSearchParams(document.location.search)};return{name:ot.StandaloneClient,readyToBeShown(){},onWillBeShown(){},close(e){ht(window.opener,mt,null==e?void 0:e.data),window.close()},async openModule(t,r){const i=null==r?void 0:r.params,o=n[t];if(o)return window.open(X(`${e}${o}${(null==r?void 0:r.path)||""}`,i),"_blank"),new Promise((e=>{vt(mt,(n=>{e(n)}))}));console.error(`No path found for given module name: ${t}`)},pushModule(t,r={}){const i=null==r?void 0:r.params,o=n[t];o?window.open(X(`${e}${o}`,i),"_blank"):console.error(`No path found for given module name: ${t}`)},popModule(){console.warn("popModule not implemented")},renewAuthTokens:()=>Promise.reject(),continueOnDevice:()=>Promise.resolve(),deepLink:t,getConfiguration:()=>Promise.resolve({pushEligibility:{},deepLink:t}),emitMessage(){console.warn("emitMessage not implemented")},onMessage:()=>(console.warn("onMessage not implemented"),()=>!1)}})((null==="/includes/cwa/"?void 0:"/includes/cwa/".slice(0,-1))||"",St);var Mt=(0,s.createContext)(bt),Pt=function(){return(0,s.useContext)(Mt)};function It(e){var n=e.children,t=Pt();return(0,a.jsx)(Mt.Provider,{value:t,children:n},void 0)}function Ot(e){var n=Pt(),t=(0,l.s0)(),i=(0,s.useCallback)((function(e){var n=e.pldfltcid;n&&Gn(n)}),[]);return(0,s.useEffect)((function(){var e,a=(({onAuthSuccess:e,onAuth401:n,onAuth403:t})=>async()=>{try{const n=await zn();null==e||e(n)}catch(e){if(!(e instanceof Ie))throw e;const{status:r,body:i}=e;if(401!==r){if(403===r){const{ineligibilityReason:n}=i;throw n&&(null==t||t(n)),e}throw e}null==n||n()}})({onAuth401:(e=(0,r.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.renewAuthTokens();case 2:a();case 3:case"end":return e.stop()}}),e)}))),function(){return e.apply(this,arguments)}),onAuthSuccess:i,onAuth403:function(e){t(nt,{state:{errorType:Jn.Auth,reason:e}}),n.readyToBeShown()}});_e=!0,$e(401,a),$e(403,a),(0,r.Z)(o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,zn();case 3:n=e.sent,i(n);case 5:return e.prev=5,null==$n||$n(),e.finish(5);case 8:case"end":return e.stop()}}),e,null,[[0,,5,8]])})))()}),[n,t,i]),(0,a.jsx)(a.Fragment,{children:e.children},void 0)}var jt=t(8152),wt=(0,s.createContext)({showDialog:function(){},hideDialog:function(){}}),Lt=function(){return(0,s.useContext)(wt)};function Et(e){var n=e.children,t=(0,s.useState)(!1),r=(0,jt.Z)(t,2),i=r[0],o=r[1],c=(0,s.useState)(),d=(0,jt.Z)(c,2),l=d[0],u=d[1],p=(0,s.useCallback)((function(e){u(e),o(!0)}),[u,o]),m=(0,s.useCallback)((function(){o(!1),u(void 0)}),[o,u]);return(0,a.jsxs)(wt.Provider,{value:{showDialog:p,hideDialog:m},children:[n,i&&l]},void 0)}var Dt=t(4942),Nt=t(2876),Tt="en-us",Rt={storefront:"USA",supportedLanguage:Tt,userPreferredLanguage:""},Ut=(0,s.createContext)(Rt),kt=function(e){var n=e.localeSettings,t=void 0===n?Rt:n,r=e.children,i=t.storefront,o=void 0===i?"USA":i,s=t.supportedLanguage,c=void 0===s?Tt:s,d=t.userPreferredLanguage,l=void 0===d?"":d;return(0,a.jsx)(Ut.Provider,{value:{supportedLanguage:c,storefront:o,userPreferredLanguage:l},children:r},void 0)},Ft=function(){return(0,s.useContext)(Ut)};const Bt=(e,n)=>{if(!e||!n)return;const t=n.find((n=>e===n)),r=e.split("-")[0],i=n.find((e=>{const n=e.split("-")[0],t=["no","nb","nn"],i=t.includes(r),o=t.includes(n);if(i&&o)return!0;const a=["iw","he"],s=a.includes(r),c=a.includes(n);return!(!s||!c)||r===n}));return t||i},Wt="is-rtl",Vt="is-ltr",_t=(e="")=>{const{locale:n="",iso3code:t="",iso2code:r=""}=q(window.location.href),i=n?n.toLowerCase().replace("_","-"):"",o=((e,{cookie:n}={})=>{const t=n||document.cookie;if(!t)return null;const r=t.match(`(^|;) ?${e}=([^;]*)(;|$)`);return r?r[2]:null})("geo")||"",a=f[o.toUpperCase()],s=f[r.toUpperCase()],c=e||t||s||a||"USA",d=((e="USA",n="",t={preferBagLanguage:!1,preferNoNavigator:!1,bagLanguage:void 0})=>{const r=e.toUpperCase(),{supportedLanguages:i=[]}=Ue[r]||{},o=i[0],a="en-gb",s=(n||"").toLowerCase(),c=Bt(s,i);if(t&&t.preferBagLanguage){const e=t.bagLanguage?t.bagLanguage.toLowerCase():"";return on.includes(e)?e:c||o||a}if(t.preferNoNavigator)return c||o||a;{const e=navigator.language.toLowerCase(),n=Bt(e,i);return c||n||o||a}})(c,i);return i&&i!==d&&console.warn(`Language: '${i}' not supported for storefront: '${c}'. Language loaded: ${d}.`),{userPreferredLanguage:i,supportedLanguage:d,storefront:c}};function Zt(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function $t(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Zt(Object(t),!0).forEach((function(n){(0,Dt.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Zt(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function Kt(e){var n=(0,s.useState)(),t=(0,jt.Z)(n,2),i=t[0],c=t[1];return(0,s.useEffect)((function(){(0,r.Z)(o().mark((function e(){var n,t,r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return hn("".concat(`${location.origin}/includes/cwa/`,"locales"),$t({},!1)),n="",e.prev=2,e.next=5,Ke(be("webAccountInfo"));case 5:t=e.sent,r=t.storeFrontISO3A,n=r,e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),(0,Nt.Tb)(e.t0),console.error("Failed to load account info",e.t0);case 14:return i=_t(n),e.next=17,Cn(i.supportedLanguage);case 17:a=i.storefront,We=a,o=i.supportedLanguage,Ve=o,c(i);case 20:case"end":return e.stop()}var o,a}),e,null,[[2,10]])})))()}),[]),(e=>{(0,s.useEffect)((()=>{if(!e)return;const n=Qe(e);if(n){const{isRtlLanguage:e,languageTag:t,languageCode:r}=n;document.body.classList.remove(Wt),document.body.classList.remove(Vt),document.body.classList.add(e?Wt:Vt,(e=>{const[n]=e.split("-");return en.includes(n)?"script-latin":nn.includes(n)?"script-latin-accent":tn.includes(n)?"script-non-latin":rn.includes(n)?"script-non-latin-accent":"script-latin-accent"})(t)),document.documentElement.setAttribute("dir",e?"rtl":"ltr"),document.documentElement.setAttribute("lang",t),document.documentElement.classList.add(`lang-${r}`)}}),[e])})(null==i?void 0:i.supportedLanguage),i?(0,a.jsx)(kt,{localeSettings:i,children:e.children},void 0):(0,a.jsx)(a.Fragment,{},void 0)}function Ht(){var e=Pt();return(0,a.jsx)(Ge.SV,{fallback:Pn.bind(void 0,e),children:(0,a.jsx)(Ot,{children:(0,a.jsx)(Kt,{children:(0,a.jsx)(It,{children:(0,a.jsx)(Et,{children:(0,a.jsx)(l.j3,{},void 0)},void 0)},void 0)},void 0)},void 0)},void 0)}function Gt(){return(0,s.useEffect)((function(){(async()=>{Ke(be("logout"),{method:"POST"})})()}),[]),(0,a.jsx)(a.Fragment,{},void 0)}(e=>{jn(e)})({appDelegates:{app:()=>Bn,delegateApp:()=>Bn,appVersion:()=>"2312.20.0",resourceRevNum:()=>"2312.20.0"},constraintProfiles:()=>[Fn.Web],beforeRecordEvent:async e=>(await(async()=>{await Kn})(),{...e,fields:{...e.fields||{},isSignedIn:!0,consumerId:Hn,topic:e.topic}})});const Yt=()=>{var e;const{search:n}=(0,l.TH)(),t=null===(e=Pt().deepLink)||void 0===e?void 0:e.searchParams;return(0,s.useMemo)((()=>{const e=new URLSearchParams(n);if(t)for(const[n,r]of t.entries())e.append(n,r);return e}),[t,n])};function zt(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function Jt(){var e=Yt();return(0,s.useEffect)((function(){var n,t={},r=function(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return zt(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?zt(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==t.return||t.return()}finally{if(s)throw o}}}}(e);try{for(r.s();!(n=r.n()).done;){var i=(0,jt.Z)(n.value,2),o=i[0],a=i[1];t[o]=a}}catch(e){r.e(e)}finally{r.f()}ht(window.opener,mt,t),window.close()}),[e]),(0,a.jsx)(a.Fragment,{},void 0)}var qt,Xt,Qt,er,nr,tr,rr,ir,or,ar;(Qt=qt||(qt={})).NONE="None",Qt.APPLE_PAY_CLASSIC="applePayClassic",Qt.CARRIER="CBXX",Qt.CREDIT_CARD="CreditCard",Qt.STORE_CREDIT="storeCredit",Qt.PAYCASH="PayCash",Qt.PAYPAL="PayPal",Qt.WECHAT="WCPY",Qt.ALIPAY="APWC",Qt.PAY_EASE="PayEase",Qt.BANCONTACT="BANCONTACT",Qt.IDEAL="IDEAL",Qt.KAKAO="KAKO",Qt.PAYCO="PAYCO",Qt.ALIPAY_HONG_KONG="APHK",Qt.PAY_TM="PYTM",Qt.TOUCH_N_GO="TNG",Qt.MOMO="MOMO",Qt.PAY_MAYA="MAYA",Qt.GCASH="GCASH",Qt.DANA="DANA",Qt.GOPAY="GoPay",Qt.EPS="EPS",Qt.BLIK="BLIK",Qt.NETBANKING="NetBanking",Qt.UPI="UPI",Qt.RUPAY="RuPay",Qt.SHPY="SHPY",Qt.PYPY="PYPY",function(e){e[e.Requires3dSecure=9980]="Requires3dSecure",e[e.RequiresExternalVerification=9990]="RequiresExternalVerification",e[e.RequiresTokenConfirmation=9991]="RequiresTokenConfirmation"}(Xt||(Xt={})),(ar=er||(er={})).Visa="Visa",ar.MasterCard="MasterCard",ar.Discover="Discover",ar.AmericanExpress="Amex",ar.Maestro="Switch",ar.DinersClub="Diners Club",ar.ChinaUnionPay="UPCC",(nr||(nr={})).ChinaUnionPay="UPDC",(or=tr||(tr={})).Credit="CREDIT",or.Debit="DEBIT",(ir=rr||(rr={})).ADD_PAYMENT="addPayment",ir.EDIT_PAYMENT="editPayment",ir.ADD_FUNDS="addFunds";const sr=e=>{if("paymentMethodType"in e&&"isApplePayPayment"in e&&"applePayCardDetails"in e){const{paymentMethodType:n}=e;return n===qt.CREDIT_CARD}return!1},cr=e=>"partnerAppId"in e,dr=e=>{if("paymentMethodType"in e){const{paymentMethodType:n}=e;return n===qt.CREDIT_CARD}return!1},lr=e=>"storeCredit"===e.paymentMethodType,ur=e=>"userPresentableErrorMessage"in e,pr=e=>"key"in e&&"message"in e&&"explanation"in e;var mr=t(9889);function hr(e){var n=e.title,t=e.description,r=e.axLabel,i=e.isDisabled,o=e.onDismiss,s=e.buttons,c=e.workingText;return(0,a.jsxs)(Ye.bZ,{visible:!0,onDismiss:o||function(){},axLabel:r||n||"",workingText:c,children:[(0,a.jsx)(Ye.BZ,{disabled:i,children:(0,a.jsxs)(Ye.MJ,{children:[(0,a.jsx)(Ye.xe,{children:(0,a.jsx)(mr.Z,{},void 0)},void 0),(0,a.jsx)(Ye.Cd,{children:n},void 0),(0,a.jsx)(Ye.X,{children:t},void 0)]},void 0)},void 0),s&&s.length>0&&(0,a.jsx)(Ye.WQ,{children:s},void 0)]},void 0)}var fr=function(){var e=Lt(),n=e.showDialog,t=e.hideDialog;return{showAlertDialog:(0,s.useCallback)((function(e){var r=e.title,i=e.description,o=e.okButtonTitle;n((0,a.jsx)(hr,{title:r,description:i,buttons:[(0,a.jsx)(Ye.zx,{onClick:t,children:o},"ok")]},void 0))}),[n,t]),hideDialog:t}};const gr=e=>e?"string"==typeof e?e:Array.isArray(e)?e.map((e=>gr(e))).join(" ").trim():Object.entries(e).reduce(((e,[n,t])=>{if(!t)return e;const r=gr(n);if(!r)return e;let i=e;return""!==i&&(i+=" "),i+r}),""):"";function yr(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function vr(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?yr(Object(t),!0).forEach((function(n){(0,Dt.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):yr(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function Cr(e){var n=e.variant,t=e.color,r=e.width,i=e.height,o=e.className;return(0,a.jsx)("span",{className:gr(["symbol","symbol--".concat(n),o]),style:vr({width:r,height:i},t?{backgroundColor:t}:{})},void 0)}const br=async e=>{const{creditCardNumber:n}=e;if(n){const{cardName:t}=await Ke(be("accountCardType"),{method:"POST",body:JSON.stringify({ccNumber:n})});e.creditCardType=t}return Ke(be(T),{method:"POST",body:JSON.stringify(e)})},Ar=async(e,n,t,r)=>Ke(`${be(E)}/${e}`,{method:"POST",body:JSON.stringify({cvv:n,...t||r?{creditCardExpirationMonth:t,creditCardExpirationYear:r}:{}})}),Sr=async e=>Ke(`${be(E)}/${e}`,{method:"POST",body:JSON.stringify({})}),xr=async(e,n,t)=>Ke(`${be(W)}/${e}`,{method:"POST",body:JSON.stringify({sessionId:n,otp:t})}),Mr=async(e,n)=>Ke(be(R).replace("{paymentId}",e),{method:"POST",body:JSON.stringify(n)}),Pr=e=>{if(!e)return;const{address:n,name:t,phoneNumber:r,taxId:i}=e,{order:o,addressOfficialLineFirst:a,addressOfficialCity:s,addressOfficialPostalCode:c,addressOfficialCounty:d,addressOfficialCountryCode:l,billingFirstName:u,billingLastName:p,phoneticBillingFirstName:m,phoneticBillingLastName:h,phoneOfficeNumber:f,phoneOfficeAreaCode:g,addressOfficialLineSecond:y,addressOfficialStateProvince:v,addressOfficialLineThird:C,carrierBillingMobilePhoneNumber:b,taxId:A,taxIdEntityName:S}=n;if(t&&r){const e=[],n={addressOfficialLineFirst:a,addressOfficialCity:s,addressOfficialPostalCode:c,addressOfficialCounty:d,addressOfficialCountryCode:l,addressOfficialLineSecond:y,addressOfficialStateProvince:v,addressOfficialLineThird:C,carrierBillingMobilePhoneNumber:b,order:e},{billingFirstName:u,billingLastName:p,phoneticBillingFirstName:m,phoneticBillingLastName:h,order:f}=t,{phoneOfficeAreaCode:g,phoneOfficeNumber:x,order:M}=r;o.forEach((n=>{Array.isArray(n)?e.push(n):e.push([n])})),e.unshift(f),e.push(M);const P={...n,billingFirstName:u,billingLastName:p,phoneticBillingFirstName:m,phoneticBillingLastName:h,phoneOfficeAreaCode:g,phoneOfficeNumber:x,taxId:A,taxIdEntityName:S};if(i){const{taxId:n,taxIdEntityName:t,order:r}=i;e.push(r),P.taxId=n,P.taxIdEntityName=t}return P}const x=[];return o.forEach((e=>{Array.isArray(e)&&x.push(e)})),{addressOfficialLineFirst:a,addressOfficialCity:s,addressOfficialPostalCode:c,addressOfficialCounty:d,addressOfficialCountryCode:l,addressOfficialLineSecond:y,addressOfficialLineThird:C,addressOfficialStateProvince:v,billingFirstName:u,billingLastName:p,phoneticBillingFirstName:m,phoneticBillingLastName:h,phoneOfficeAreaCode:g,phoneOfficeNumber:f,carrierBillingMobilePhoneNumber:b,taxId:A,taxIdEntityName:S,order:x}},Ir=e=>{if(!e)return;const n=e=>({...e,value:"true"===e.value||!0===e.value}),{idVerificationLegalName:t,idVerificationBirthYear:r,idVerificationBirthMonth:i,idVerificationBirthDay:o,idVerificationCarrierTelcoCode:a,idVerificationBillingMobilePhone:s,idVerificationGender:c,idVerificationKoreanNational:d,appleTermsAgreement:l,thirdPartyTermsAgreement:u}=e;return{idVerificationLegalName:t,idVerificationBirthYear:r,idVerificationBirthMonth:i,idVerificationBirthDay:o,idVerificationCarrierTelcoCode:a,idVerificationBillingMobilePhone:s,idVerificationGender:c,idVerificationKoreanNational:d,appleTermsAgreement:n(l),thirdPartyTermsAgreement:n(u)}},Or=e=>{var n;const{billingInfoFormat:t}=(null==e?void 0:e.billingInfoFormat)||{},{paymentMethods:r}=t||{},{shippingAddress:i}=t||{},{paymentInfos:o,shippingAddressInfo:a,storeCredit:s,payCash:c,storefront:d,lockStatus:l,messages:u,commerceContext:p,paymentServiceUrl:m,foundInApplePayWallet:h,foundInApplePayWalletList:f,applePayClassicSettings:g,clientUiControls:y,recommendations:v,paymentVerification:C}=e,b={userPaymentInfos:(A=o,A.map((e=>{if(e.paymentMethodType===qt.PAYPAL){const{payPalEmailAddress:n,...t}=e;return{...t,partnerLogin:n}}if((e=>"matchedPaymentInfo"in e)(e)){const{matchedPaymentInfo:n,...t}=e,{rank:r}=t;return{...n,rank:r,isDedupedDpan:!0,physicalCardDetails:t}}return e}))),paymentMethodOptions:r,addressFormFields:Pr(t),isEligibleForAppleCard:null===(n=null==y?void 0:y.promoControls)||void 0===n?void 0:n.appleCardPromoDisplay,storeCredit:s,payCash:c,storefront:d,lockStatus:l,messages:u,commerceContext:p,applePayClassicSettings:g,idVerificationFormFields:Ir(null==r?void 0:r.localCardOption),clientUiControls:y,recommendations:v,paymentVerification:C};var A;return h&&m&&(b.walletCardsOption=((e,n,t)=>({amount:null==n?void 0:n.amount,paymentServiceUrl:e,messages:null==n?void 0:n.messages,cardsList:(null==n?void 0:n.entries)||t}))(m,h,f)),i&&(b.shippingFormFields=(e=>{let n=[];const{shippingFirstName:t,shippingLastName:r,addressShippingCompanyName:i,addressShippingLineFirst:o,addressShippingLineSecond:a,addressShippingLineThird:s,addressShippingCity:c,addressShippingStateProvince:d,addressShippingPostalCode:l,addressShippingCountryCode:u,order:p}=e;return n=p.map((e=>[e])),{shippingFirstName:t,shippingLastName:r,addressShippingCompanyName:i,addressShippingLineFirst:o,addressShippingLineSecond:a,addressShippingLineThird:s,addressShippingCity:c,addressShippingStateProvince:d,addressShippingPostalCode:l,addressShippingCountryCode:u,order:n}})(i)),a&&(null==a?void 0:a.shippingAddressInfo)&&(b.userShippingAddressInfo=a.shippingAddressInfo),b},jr=async()=>{const e=await Ke(X(be(N),{context:"CWA",isVideoEverywhere:!0}));return Or(e.data.attributes)},wr=async e=>{const n=await Ke(be(U).replace("{paymentId}",e),{method:"POST"});return pr(n)?n:Or(n.data.attributes)};var Lr=t(4925),Er=["labelText","placeholders","fieldIds","values","delimiter","errorMessage","disabled","onChange"];function Dr(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}var Nr=function(e,n,t){for(var r,i="",o=0,a=0;a<e.length;a++)e[a]!==n?i+=null!==(r=t[o++])&&void 0!==r?r:e[a]:i+=n;return i},Tr=function(e,n,t){var r=t.join("");return r?Nr(e,n,r):""};function Rr(e){var n=e.labelText,t=e.placeholders,r=e.fieldIds,i=e.values,o=e.delimiter,c=void 0===o?"":o,d=e.errorMessage,l=e.disabled,u=void 0!==l&&l,p=e.onChange,m=void 0===p?function(){}:p,h=(0,Lr.Z)(e,Er),f=(0,s.useState)(null),g=(0,jt.Z)(f,2),y=g[0],v=g[1],C=(0,s.useState)(),b=(0,jt.Z)(C,2),A=b[0],S=b[1],x={axLabel:d||"",children:d},M=t.join(c);if((0,s.useEffect)((function(){y&&(null==A||A.setSelectionRange(y,y))}),[A,y]),r.length!==i.length)throw new Error("Number of fieldIds must match the number of provided values");if(c&&t.length!==r.length)throw new Error("Number of tokens in the placeholder must match the number of fieldIds");var P=(0,s.useCallback)((function(e){var n=e.target,t=n.value.replace(/\D/g,"").replace(c,""),i=t.length;A||S(n);var o=function(e,n){var t=e.split(""),r=[];return t.forEach((function(e,t){e===n&&r.push(t)})),r}(M,c),a=o.findIndex((function(e){return e>=i})),s=-1===a?o.length:a;v(i+s),m(e,function(e,n,t){var r={};return e.split(n).forEach((function(e,n){r[t[n]]=e.replace(/\D/g,"")})),r}(Nr(M,c,t),c,r))}),[c,r,A,m,M]);return(0,a.jsx)(Ye.nv,function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Dr(Object(t),!0).forEach((function(n){(0,Dt.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Dr(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({labelText:n,value:Tr(M,c,i),placeholder:M,onInput:P,errorMessage:x,disabled:u},h),void 0)}function Ur(e){var n=e.field,t=e.value,r=e.errorMessage,i=e.testId,o=void 0===i?"":i,s=e.isDisabled,c=void 0!==s&&s,d=e.isNumeric,l=void 0!==d&&d,u=e.onInputChange,p=n.id,m=n.label,h=n.placeholder,f=n.options,g=m||"",y={axLabel:r||"",children:r},v=p,C=p;if(f){var b=f.map((function(e){return(0,a.jsx)(Ye.Qr,{label:e.displayName,value:e.value},e.name)}));return(0,a.jsx)(Ye.Lt,{name:v,labelText:g,value:t,placeholder:h,onChange:u,errorMessage:y,"data-test":o,disabled:c,children:b},C)}var A=l?Ye._:Ye.nv;return(0,a.jsx)(A,{name:v,value:t,labelText:g,placeholder:h,errorMessage:y,"data-test":o,onChange:u,disabled:c},C)}var kr=["creditCardNumber","creditVerificationNumber","creditCardExpirationMonth","creditCardExpirationYear"],Fr="creditCardExpirationYear",Br="creditCardExpirationMonth";function Wr(e){var n=e.formFields,t=e.formFieldsOrder,r=e.formValues,i=void 0===r?{}:r,o=e.validationErrors,c=void 0===o?[]:o,d=e.testIdPrefix,l=void 0===d?"":d,u=e.onInputChange,p=void 0===u?function(){}:u,m=e.isReadOnly,h=void 0!==m&&m,f=e.disabledFieldIds,g=void 0===f?[]:f,y=e.excludedFieldIds,v=void 0===y?[]:y,C=t||n.order,b=(0,s.useCallback)((function(e,t){var r,o,s,d=n[e];if(d&&!(null==v?void 0:v.includes(e))&&e!==Fr){var u=c.find((function(n){return n.propertyName===e})),m=null==u?void 0:u.errorString,f=d.id,y=(null===(r=i[f])||void 0===r?void 0:r.toString())||"",C=l?"".concat(l,"-").concat(f):"",b=h||(null==g?void 0:g.includes(f)),A=f;if(f===Br){var S=c.find((function(e){var n=e.propertyName||e.field;return n===Br||n===Fr})),x=null==S?void 0:S.errorString,M=t.flat().indexOf(Br)<t.flat().indexOf(Fr),P=M?Br:Fr,I=null===(o=n[P])||void 0===o?void 0:o.placeholder,O=i[P]||"",j=M?Fr:Br,w=null===(s=n[j])||void 0===s?void 0:s.placeholder,L=i[j]||"";if(!I||!w)throw new Error("Missing placeholder(s) for expiration date fields");return(0,a.jsx)(Rr,{fieldIds:[P,j],values:[O,L],placeholders:[I,w],errorMessage:x,delimiter:"/",labelText:Mn("CommerceUI.CWA.PaymentMethods.PaymentFields.ExpirationDate.Label"),onChange:p,disabled:b,"data-test":C},A)}return(0,a.jsx)(Ur,{field:d,value:y,errorMessage:m,testId:C,isDisabled:b,isNumeric:kr.includes(d.id),onInputChange:p},A)}}),[g,h,v,n,i,p,l,c]);return(0,a.jsx)(a.Fragment,{children:C.map((function(e,n,t){return Array.isArray(e)?(0,a.jsx)("div",{className:"form-fields__row",children:e.map((function(e){return b(e,t)}))},"".concat(e.join("-"))):b(e,t)})).filter(Boolean)},void 0)}var Vr=["phoneOfficeAreaCode","phoneOfficeNumber"];function _r(e){var n=e.formFields,t=e.formValues,r=e.validationErrors,i=e.isReadOnly,o=e.onInputChange,c=(0,s.useMemo)((function(){var e=[],t=[],r=[],i=[],o=[];return n.order.flat().forEach((function(n){["billingFirstName","billingLastName"].includes(n)?e.push(n):["addressOfficialLineFirst","addressOfficialLineSecond"].includes(n)?t.push(n):["addressOfficialCity","addressOfficialStateProvince","addressOfficialPostalCode"].includes(n)?r.push(n):"addressOfficialCountryCode"===n?i.push(n):Vr.includes(n)||o.push([n])})),[e,t,r,i].concat(o)}),[n.order]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Ye.z,{children:Mn("CommerceUI.CWA.PaymentMethods.AddressFields.Header")},void 0),(0,a.jsx)("div",{className:"address-fields","data-test":"address-fields",children:(0,a.jsx)(Wr,{formFields:n,formFieldsOrder:c,formValues:t,validationErrors:r,onInputChange:o,testIdPrefix:"address-field",isReadOnly:i,disabledFieldIds:["addressOfficialCountryCode"],excludedFieldIds:Vr},void 0)},void 0)]},void 0)}var Zr=["ccTypes"];function $r(e){var n=e.formFields,t=e.formValues,r=e.validationErrors,i=e.addressFieldsComponent,o=e.isStackLocked,c=e.isEditPayment,d=e.onInputChange,l=[];c?l.push("creditCardNumber"):o&&l.push(n.order.flat().filter((function(e){return!r.find((function(n){return n.propertyName===e}))})));var u=(0,s.useMemo)((function(){var e=[],t=[],r=[];return n.order.flat().forEach((function(n){"creditCardNumber"===n?e.push(n):["creditCardExpirationMonth","creditCardExpirationYear","creditVerificationNumber"].includes(n)?t.push(n):Zr.includes(n)||r.push([n])})),[e,t].concat(r)}),[n.order]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Ye.z,{children:Mn("CommerceUI.CWA.PaymentMethods.PaymentFields.Header")},void 0),(0,a.jsx)("div",{className:"credit-card-fields","data-test":"credit-card-fields",children:(0,a.jsx)(Wr,{formFields:n,formFieldsOrder:u,formValues:t,validationErrors:r,onInputChange:d,testIdPrefix:"payment-field",disabledFieldIds:l,excludedFieldIds:Zr},void 0)},void 0),i]},void 0)}const Kr=e=>{const[n,t]=(0,s.useState)(""),{storefront:r}=Ft(),i=(0,l.oQ)(tt);return(0,s.useEffect)((()=>{(async()=>{if(!e)return;const n=await(async(e,n,t)=>{const{partnerUrl:r}=await Ke(X(e,{iso3CountryCode:n,redirectUrl:t,appInstalled:0}));return r})(e,r,encodeURIComponent(`${location.protocol}//${location.host}${i}`));n&&t(n)})()}),[r,e,i]),n},Hr={PAYPAL:{version:1,isEmailRequired:!0},WCPY:{version:1},APWC:{version:2},KAKO:{version:2},APHK:{version:2},PYTM:{version:2},TNG:{version:2},MOMO:{version:1},MAYA:{version:1},GCASH:{version:1},DANA:{version:1},PAYCO:{version:1},GOPAY:{version:1},SHPY:{version:1},PYPY:{version:1}};Error;const Gr=e=>(null==e?void 0:e.toUpperCase())in Hr,Yr=(qt.BANCONTACT.toLowerCase(),qt.IDEAL.toLowerCase(),qt.EPS.toLowerCase(),qt.BLIK.toLowerCase(),qt.NETBANKING.toLowerCase(),qt.UPI.toLowerCase(),qt.RUPAY.toLowerCase(),qt.PAY_EASE.toLowerCase(),qt.UPI.toLowerCase(),(e,n,t)=>{let r="";for(let i=1;i<=(t||1);i++)r+=`${e.repeat(n)} `;return r.trim()}),zr=e=>e.canChallenge,Jr=e=>`${Yr("•",4)} ${e.last4CCDigits}`,qr=e=>{if(sr(e)){const{applePayCardDetails:n}=e;return"APPLE_PAY_CASH"===(null==n?void 0:n.applePayType)}return!1},Xr=e=>{if(sr(e)){const{applePayCardDetails:n}=e;return"APPLE_PAY_BROADWAY"===(null==n?void 0:n.applePayType)}return!1},Qr=e=>qr(e)||Xr(e)||(e=>{if(sr(e)){const{applePayCardDetails:{applePayType:n}}=e;return"APPLE_PAY_CARD"===n}return!1})(e)||(e=>{if(sr(e)){const{applePayCardDetails:{applePayType:n}}=e;return"APPLE_PAY_CARD_MPAN"===n}return!1})(e),ei=e=>{if((e=>{if("paymentMethodType"in e&&"account"in e&&"balance"in e){const{paymentMethodType:n}=e;return n===qt.PAYCASH}return!1})(e))return e.translatedDisplayNameForCC;if((e=>{if("paymentMethodType"in e&&"formattedAmountForDisplay"in e){const{paymentMethodType:n}=e;return n===qt.STORE_CREDIT}return!1})(e))return e.label;const{translatedDisplayNameForCC:n}=e;if(sr(e)){const{applePayCardDetails:t}=e;return(null==t?void 0:t.shortDescription)||n}return n},ni=(e,n)=>{if(e.paymentMethodType===qt.CREDIT_CARD)return n?Jr(e):e.last4CCDigits;if(e.paymentMethodType===qt.CARRIER)return((e,n,t)=>{const r=new RegExp(".(?=.{"+n+",}$)","g");return e.replace(r,t)})(e.carrierBillingMobilePhoneNumber||"",4,n?"•":"");if(Gr(e.paymentMethodType))return e.partnerLogin;if("last4CCDigits"in e){const{last4CCDigits:t}=e;return n?`${Yr("•",4)} ${t}`:t}return""},ti=e=>Array.from(e).sort(((e,n)=>e.rank-n.rank)),ri=e=>e.map((({paymentId:e,rank:n})=>({paymentId:e,rank:n})));var ii;!function(e){e.EditPayment="EditPayment",e.SmsVerificationAurum="SmsVerificationAurum",e.SmsVerificationCarrier="SmsVerificationCarrier",e.SmsVerificationCupCard="SmsVerificationCupCard",e.SmsVerificationExternal="SmsVerificationExternal",e.SmsVerificationExternalUpi="SmsVerificationExternalUpi"}(ii||(ii={}));const oi=(e,n,t)=>{if(n){if((e=>{const{creditCardType:n}=e;return n===er.ChinaUnionPay||n===nr.ChinaUnionPay})(e))return ii.SmsVerificationCupCard;const{paymentMethodType:n}=e;return n===qt.CARRIER?ii.SmsVerificationCarrier:Gr(n)?ii.SmsVerificationExternal:zr(e)&&Qr(e)?ii.SmsVerificationAurum:ii.EditPayment}return t?ii.SmsVerificationExternalUpi:ii.EditPayment},ai=(Date.now(),Error,()=>{const[e,n]=(0,s.useState)({}),[t,r]=(0,s.useState)([]),[i,o]=(0,s.useState)(!1);return{formValues:e,setFormValues:n,validationErrors:t,setValidationErrors:r,isDirty:i,setIsDirty:o,handleInputChange:(a,s)=>{const{target:c}=a,d=s||c.value,l=c.name;r(t.filter((e=>e.propertyName!==l))),n("object"==typeof d?{...e,...d}:{...e,[l]:d}),d===e[l]||i||o(!0)}}});var si,ci=(0,s.createContext)({setPaymentInfos:function(){},loadPaymentInfos:(si=(0,r.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return si.apply(this,arguments)})});function di(e){var n=e.children,t=(0,s.useState)(),i=(0,jt.Z)(t,2),c=i[0],d=i[1],l=Pt(),u=(0,s.useCallback)((0,r.Z)(o().mark((function e(){var n,t,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.getConfiguration();case 3:if(t=e.sent,!(null===(n=t.data)||void 0===n?void 0:n.paymentInfos)){e.next=7;break}return d(t.data.paymentInfos),e.abrupt("return");case 7:e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),(0,Nt.Tb)(e.t0),console.warn("Failed to load client configuration. Loading paymentInfos fresh.");case 13:return e.next=15,jr();case 15:r=e.sent,d(r);case 17:case"end":return e.stop()}}),e,null,[[0,9]])}))),[l]);return(0,a.jsx)(ci.Provider,{value:{paymentInfos:c,setPaymentInfos:d,loadPaymentInfos:u},children:n},void 0)}var li=function(){return(0,s.useContext)(ci)};const ui=(e="")=>{const{paymentInfos:n}=li(),[t,r]=(0,s.useState)(),[i,o]=(0,s.useState)(e);return(0,s.useEffect)((()=>{if(!n)return;const{userPaymentInfos:e,storeCredit:t}=n;i===qt.STORE_CREDIT?r(t):r(i?e.find((e=>e.paymentId===i)):e[0])}),[i,n]),{userPaymentInfo:t,targetPaymentId:i,setTargetPaymentId:o}},pi=(e=qt.CREDIT_CARD,n="")=>{const{paymentInfos:t}=li(),[r,i]=(0,s.useState)(e),[o,a]=(0,s.useState)(!0),{userPaymentInfo:c,targetPaymentId:d,setTargetPaymentId:l}=ui(n),[u,p]=(0,s.useState)(),[m,h]=(0,s.useState)(),[f,g]=(0,s.useState)(),{formValues:y,setFormValues:v,validationErrors:C,setValidationErrors:b,isDirty:A,setIsDirty:S,handleInputChange:x}=ai();return(0,s.useEffect)((()=>{if(!t||!r)return;const{paymentMethodOptions:e}=t;p(e);const n=(i=r,(o=e).order.map((e=>o[e])).find((e=>(null==e?void 0:e.value)===i)));var i,o;if(h(n),g(t.addressFormFields),c){const e=((e,n,t)=>{var r,i;const o=null===(r=null==t?void 0:t.order)||void 0===r?void 0:r.flat();return{...null===(i=null==n?void 0:n.order)||void 0===i?void 0:i.flat().reduce(((n,t)=>{const r=e[t]||e.billingAddress[t]||e.phone[t];return r&&(n[t]=r.toString()),n}),{}),...null==o?void 0:o.reduce(((n,t)=>{if(dr(e)&&"creditCardNumber"===t)n[t]=`•••• •••• •••• ${e.last4CCDigits}`;else{const r=e[t];r&&(n[t]=r.toString())}return n}),{})}})(c,t.addressFormFields,d?n:void 0);e.phoneOfficeAreaCode="",e.phoneOfficeNumber="",v(e),b(c.validationErrors)}a(t.lockStatus.isStackLocked)}),[t,d,r,c,v,b]),{targetPaymentType:r,setTargetPaymentId:l,targetPaymentId:d,setTargetPaymentType:i,paymentMethodOptions:u,paymentFormFields:m,addressFormFields:f,formValues:y,setFormValues:v,validationErrors:C,setValidationErrors:b,isStackLocked:o,isDirty:A,setIsDirty:S,handleInputChange:x}},mi=()=>{const{paymentInfos:e}=li(),{userPaymentInfo:n}=ui(),{storefront:t}=Ft(),{formValues:r,setFormValues:i,validationErrors:o,setValidationErrors:a,isDirty:c,setIsDirty:d,handleInputChange:l}=ai(),u=(0,s.useMemo)((()=>null==n?void 0:n.billingAddress),[n]),p=(0,s.useMemo)((()=>!!(null==e?void 0:e.userShippingAddressInfo)),[e]),m=(0,s.useMemo)((()=>null==e?void 0:e.shippingFormFields),[e]);return(0,s.useEffect)((()=>{if(e){const{userShippingAddressInfo:n}=e;i({...n,addressShippingCountryCode:t})}}),[e,t,i]),{formFields:m,formValues:r,setFormValues:i,validationErrors:o,setValidationErrors:a,isDirty:c,setIsDirty:d,handleInputChange:l,hasShippingAddress:p,defaultBillingAddress:u}};function hi(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function fi(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?hi(Object(t),!0).forEach((function(n){(0,Dt.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):hi(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function gi(e){var n=e.paymentOptionDetail,t=e.formValues,r=e.setFormValues,i=e.setShouldShowSubmit,o=e.addressFieldsComponent,c=(0,s.useState)(""),d=(0,jt.Z)(c,2),l=d[0],u=d[1],p=Kr(n.signUpUrl),m=fr().showAlertDialog;(0,s.useEffect)((function(){var e=function(e){e&&"error"!==e.status?"cancel"!==e.status&&("string"==typeof e.email&&u(e.email),"string"==typeof e.baToken&&(r(fi(fi({},t),{},{paymentMethodType:qt.PAYPAL,ba_token:e.baToken})),i(!0))):m({title:Mn("CommerceUI.CWA.PaymentMethods.AddModal.Error.Title"),description:Mn("CommerceUI.CWA.PaymentMethods.AddModal.Error.Generic"),okButtonTitle:Mn("CommerceUI.CWA.PaymentMethods.AddModal.Error.CTA")})};return vt(mt,e),function(){Ct(mt,e)}}),[t,r,i,m]);var h=function(){open(p,"_blank")};return(0,a.jsxs)("div",{className:"pay-pal-linking",children:[l?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Ye.z,{children:Mn("CommerceUI.CWA.PaymentMethods.PayPal.AccountDetails.Header")},void 0),(0,a.jsx)("div",{children:l},void 0),(0,a.jsx)("a",{href:"#",onClick:h,children:Mn("CommerceUI.CWA.PaymentMethods.PayPal.AccountDetails.UseDifferentAccount.Button.Label")},void 0)]},void 0):(0,a.jsxs)(Ye.zx,{onClick:h,disabled:!p,children:[Mn("CommerceUI.CWA.PaymentMethods.PayPal.SignIn.Button.Label")," ",!p&&(0,a.jsx)(Ye.$j,{axLabel:""},void 0)]},void 0),l&&o]},void 0)}function yi(e){var n,t=e.paymentType,r=e.paymentFormFields,i=e.addressFormFields,o=e.formValues,s=e.setFormValues,c=e.validationErrors,d=e.isStackLocked,l=e.isEditPayment,u=e.isApplePay,p=e.setShouldShowSubmit,m=e.onInputChange,h=(0,a.jsx)(_r,{formFields:i,formValues:o,validationErrors:c,isReadOnly:d||u,onInputChange:m},void 0);return(0,a.jsxs)("form",{"data-test":"payment-form",children:[!u&&(0,a.jsx)(a.Fragment,{children:(n=r,"creditCardNumber"in n&&(0,a.jsx)($r,{formFields:r,formValues:o,validationErrors:c,isStackLocked:d,isEditPayment:l,onInputChange:m,addressFieldsComponent:h},void 0))},void 0),u&&h,t===qt.PAYPAL&&cr(r)&&(0,a.jsx)(gi,{paymentOptionDetail:r,formValues:o,setFormValues:s,addressFieldsComponent:h,setShouldShowSubmit:p},void 0)]},void 0)}function vi(e){var n=e.axLabel,t=e.header,i=e.body,c=e.error,d=e.isDisabled,l=e.shouldShowSubmit,u=e.onDismiss,p=e.onSubmit,m=(0,s.useState)(!1),h=(0,jt.Z)(m,2),f=h[0],g=h[1],y=function(){var e=(0,r.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p){e.next=2;break}return e.abrupt("return");case 2:return g(!0),e.prev=3,e.next=6,p(n);case 6:return e.prev=6,g(!1),e.finish(6);case 9:case"end":return e.stop()}}),e,null,[[3,,6,9]])})));return function(n){return e.apply(this,arguments)}}(),v=d||f;return(0,a.jsxs)(Ye.u_,{visible:!0,onDismiss:u,axLabel:n,axCloseButtonLabel:Mn("CommerceUI.AX.Close"),children:[(0,a.jsxs)(Ye.hz,{disabled:v,children:[(0,a.jsx)(Ye.xB,{children:t},void 0),c&&(0,a.jsx)(Ye.Bc,{inline:!0,children:c},void 0),(0,a.jsx)(Ye.fe,{children:i},void 0)]},void 0),p&&l&&(0,a.jsx)(Ye.dm,{centered:!0,children:(0,a.jsx)(Ye.zx,{type:"submit",onClick:y,disabled:v,children:Mn("CommerceUI.CWA.PaymentMethods.AddOrEditModal.Button.Primary")},void 0)},void 0)]},void 0)}function Ci(){var e=pi(),n=e.paymentMethodOptions,t=e.paymentFormFields,i=e.addressFormFields,c=e.formValues,d=e.setFormValues,l=e.validationErrors,u=e.setValidationErrors,p=e.handleInputChange,m=e.targetPaymentType,h=e.setTargetPaymentType,f=e.isDirty,g=e.setIsDirty,y=Pt(),v=fr().showAlertDialog,C=li().loadPaymentInfos;(0,s.useEffect)((function(){C()}),[C]),(0,s.useEffect)((function(){t&&y.readyToBeShown()}),[y,t]);var b=(0,s.useCallback)((function(e){v({title:Mn("CommerceUI.CWA.PaymentMethods.AddModal.Error.Title"),description:e,okButtonTitle:Mn("CommerceUI.CWA.PaymentMethods.AddModal.Error.CTA")})}),[v]);if(!t||!i||!n)return null;var A=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Ye.dB,{children:(0,a.jsx)(Cr,{variant:"creditcard",width:55,height:55},void 0)},void 0),(0,a.jsx)(Ye.r6,{children:Mn("CommerceUI.CWA.PaymentMethods.AddModal.Title")},void 0),(0,a.jsx)(Ye.k,{children:Mn("CommerceUI.CWA.PaymentMethods.AddModal.Description")},void 0),(0,a.jsx)(Ye.uN,{typography:"caption",children:Mn("CommerceUI.CWA.PaymentMethods.AddModal.Disclosure")},void 0)]},void 0),S=function(){var e=(0,r.Z)(o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u([]),e.prev=1,e.next=4,br(c);case 4:n=e.sent,e.next=12;break;case 7:return e.prev=7,e.t0=e.catch(1),(0,Nt.Tb)(e.t0),b(Mn("CommerceUI.CWA.PaymentMethods.AddModal.Error.Generic")),e.abrupt("return");case 12:ur(n)?b(n.userPresentableErrorMessage):n.result.validationResults?u(n.result.validationResults):y.close({data:{shouldReload:!0}});case 13:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}(),x=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Ye.Lt,{labelText:Mn("CommerceUI.CWA.PaymentMethods.AddModal.PaymentTypeField.Label"),onChange:function(e){h(e.target.value),g(!1)},value:m,children:n.order.map((function(e){var t=n[e];if(t&&"None"!==t.value)return(0,a.jsx)(Ye.Qr,{value:t.value,children:t.displayName},t.id)}))},void 0),(0,a.jsx)(yi,{paymentType:m,paymentFormFields:t,addressFormFields:i,formValues:c,setFormValues:d,validationErrors:l,isStackLocked:!1,setShouldShowSubmit:g,onInputChange:p},void 0)]},void 0);return(0,a.jsx)(vi,{axLabel:Mn("CommerceUI.CWA.PaymentMethods.AddModal.Title"),header:A,body:x,shouldShowSubmit:f,onDismiss:function(){return y.close()},onSubmit:S},void 0)}function bi(e){var n=e.title,t=e.instruction,r=e.sendCodeErrorMessage,i=e.verifyCodeErrorMessage,o=e.isLoading,c=e.isSubmitting,d=e.onResendCodeClick,l=e.onCancelClick,u=e.onSubmitClick,p=e.underInputButtons,m=(0,s.useState)(""),h=(0,jt.Z)(m,2),f=h[0],g=h[1],y=(0,s.useCallback)((function(e){g(e.target.value)}),[]);return(0,a.jsxs)(Ye.bZ,{visible:!0,onDismiss:l,axLabel:Mn("CommerceUI.CWA.CodeVerification.Title"),children:[(0,a.jsxs)(Ye.BZ,{children:[(0,a.jsxs)(Ye.MJ,{children:[(0,a.jsx)(Ye.xe,{children:(0,a.jsx)(mr.Z,{},void 0)},void 0),(0,a.jsx)(Ye.Cd,{children:n},void 0),t&&(0,a.jsx)(Ye.X,{children:t},void 0),(r||i)&&(0,a.jsx)("div",{className:"code-verification-dialog__error-message",children:(0,a.jsx)(Ye.Bc,{inline:!0,children:r||i},void 0)},void 0)]},void 0),(0,a.jsx)(Ye.T2,{children:o?(0,a.jsx)("div",{className:"code-verification-dialog__loading-spinner",children:(0,a.jsx)(Ye.$j,{axLabel:""},void 0)},void 0):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{children:!r&&(0,a.jsx)(Ye._,{value:f,labelText:"Enter Code",onChange:y},void 0)},void 0),(0,a.jsxs)("div",{className:"code-verification-dialog__under-input-buttons",children:[(0,a.jsx)(Ye.zx,{link:!0,onClick:d,children:Mn("CommerceUI.CWA.CodeVerification.ResendCode")},void 0),p&&p.map((function(e,n){return(0,a.jsxs)(s.Fragment,{children:[(0,a.jsx)("span",{className:"code-verification-dialog__spacer"},void 0),e]},n)}))]},void 0)]},void 0)},void 0)]},void 0),(0,a.jsxs)(Ye.WQ,{children:[(0,a.jsx)(Ye.zx,{color:"secondary",onClick:l,disabled:c,children:Mn("CommerceUI.CWA.CodeVerification.Cancel")},void 0),(0,a.jsx)(Ye.zx,{type:"submit",onClick:function(){u(f)},disabled:o||c||!!r,children:Mn("CommerceUI.CWA.CodeVerification.Submit")},void 0)]},void 0)]},void 0)}var Ai=t(3144),Si=t(5671),xi=t(136),Mi=t(4575),Pi=t(1120);var Ii=function(e){(0,xi.Z)(i,e);var n,t,r=(n=i,t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,Pi.Z)(n);if(t){var i=(0,Pi.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,Mi.Z)(this,e)});function i(e,n,t){var o;return(0,Si.Z)(this,i),(o=r.call(this,e)).name="AlertableError",o.alertTitle=n,o.alertDescription=t,o}return(0,Ai.Z)(i)}((0,t(2407).Z)(Error));function Oi(e){var n=e.title,t=e.description,i=e.cancelButtonLabel,c=e.confirmButtonLabel,d=e.onConfirm,l=e.onSuccess,u=e.onFailure,p=e.onClose,m=(0,s.useState)(!1),h=(0,jt.Z)(m,2),f=h[0],g=h[1],y=function(){var e=(0,r.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,g(!0),e.next=4,d();case 4:null==l||l(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),null==u||u(e.t0);case 10:return e.prev=10,g(!1),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[0,7,10,13]])})));return function(){return e.apply(this,arguments)}}();return(0,a.jsx)(hr,{isDisabled:f,title:n,description:t,buttons:[(0,a.jsx)(Ye.zx,{disabled:f,onClick:p,"data-test":"confirmation-dialog-cancel",children:i},"cancel"),(0,a.jsx)(Ye.zx,{disabled:f,onClick:y,color:"secondary","data-test":"confirmation-dialog-confirm",children:c},"confirm")]},void 0)}function ji(){return(ji=(0,r.Z)(o().mark((function e(n){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,wr(n);case 2:if(t=e.sent,!pr(t)){e.next=5;break}throw new Ii(t.key,t.message,t.explanation);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function wi(e){var n=e.paymentId,t=e.confirmationDescription,r=e.onClose,i=void 0===r?function(){}:r,o=e.onRemoveSuccess,s=void 0===o?function(){}:o,c=fr().showAlertDialog;return(0,a.jsx)(Oi,{title:Mn("CommerceUI.CWA.PaymentMethods.Remove.Confirmation.Title"),description:t,cancelButtonLabel:Mn("CommerceUI.CWA.PaymentMethods.Remove.Confirmation.Cancel"),confirmButtonLabel:Mn("CommerceUI.CWA.PaymentMethods.Remove.Confirmation.Confirm"),onConfirm:function(){return function(e){return ji.apply(this,arguments)}(n)},onSuccess:s,onFailure:function(e){var n,t;e instanceof Ii?(n=e.alertTitle,t=e.alertDescription):((0,Nt.Tb)(e),n=Mn("CommerceUI.CWA.PaymentMethods.Remove.FailureDialog.Title"),t=Mn("CommerceUI.CWA.PaymentMethods.Remove.FailureDialog.Description")),c({title:n,description:t,okButtonTitle:Mn("CommerceUI.CWA.PaymentMethods.Remove.FailureDialog.CTA")})},onClose:i},void 0)}function Li(e){var n=e.paymentMethod,t=e.onSubmitSuccess,i=e.onDismiss,c=(0,s.useState)(!0),d=(0,jt.Z)(c,2),l=d[0],u=d[1],p=(0,s.useState)(!1),m=(0,jt.Z)(p,2),h=m[0],f=m[1],g=(0,s.useState)(""),y=(0,jt.Z)(g,2),v=y[0],C=y[1],b=(0,s.useState)(""),A=(0,jt.Z)(b,2),S=A[0],x=A[1],M=(0,s.useState)(""),P=(0,jt.Z)(M,2),I=P[0],O=P[1],j=(0,s.useState)(""),w=(0,jt.Z)(j,2),L=w[0],E=w[1],D=Lt(),N=D.hideDialog,T=D.showDialog,R=n.paymentId,U=(0,s.useCallback)((0,r.Z)(o().mark((function e(){var n,t,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),x(""),O(""),e.next=5,Sr(R);case 5:n=e.sent,u(!1),xe(n)?x(n.errorMessage||""):(t=n.instruction,r=n.sessionId,t&&C(t),r&&E(r));case 8:case"end":return e.stop()}}),e)}))),[R]);(0,s.useEffect)((function(){U()}),[U]);var k=(0,s.useCallback)(function(){var e=(0,r.Z)(o().mark((function e(n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(""),f(!0),e.next=4,xr(R,L,n);case 4:r=e.sent,f(!1),xe(r)?O(r.errorMessage||""):t({shouldReload:!0});case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[R,L,t]);return(0,a.jsx)(bi,{title:Mn("CommerceUI.CWA.PaymentMethods.CodeVerification.Title"),instruction:v,sendCodeErrorMessage:S,verifyCodeErrorMessage:I,isLoading:l,isSubmitting:h,onResendCodeClick:U,onCancelClick:i,onSubmitClick:k,underInputButtons:[(0,a.jsx)(Ye.zx,{link:!0,onClick:function(){T((0,a.jsx)(wi,{paymentId:n.paymentId,onRemoveSuccess:function(){t({shouldReload:!0})},onClose:N,confirmationDescription:Mn("CommerceUI.CWA.PaymentMethods.Remove.PaymentMethod.Confirmation.Description",{paymentName:ei(n)||""})},void 0))},children:Mn("CommerceUI.CWA.PaymentMethods.CodeVerification.RemovePayment")},"removePayment")]},void 0)}function Ei(e){var n=e.description,t=e.manualInstructionsDesktop,r=e.manualInstructionsMobile,i=e.className,o=e.title,s=e.isPushEligible,c=e.didSend,d=e.isSending,l=e.handleDeviceHandoff,u=s?(0,a.jsx)("div",{className:"device-handoff-card-layout-banner__action",children:d?(0,a.jsxs)("div",{className:"device-handoff-card-layout-banner__action-pending",children:[(0,a.jsx)(Ye.$j,{axLabel:""},void 0),(0,a.jsx)("span",{className:"device-handoff-card-layout-banner__action-pending-text",children:(0,a.jsx)(Ye.xv,{weight:"medium",children:Mn("CommerceUI.CWA.DeviceHandoffCard.SendingNotification")},void 0)},void 0)]},void 0):(0,a.jsx)(Ye.zx,{link:!0,onClick:l,children:(0,a.jsxs)("span",{className:"device-handoff-card-layout-banner__action-button","data-test":"device-handoff-card-action-button",children:[(0,a.jsx)(Cr,{variant:"iphone",width:17,height:17},void 0),(0,a.jsx)("span",{className:"device-handoff-card-layout-banner__action-text",children:(0,a.jsx)(Ye.xv,{typography:"body-tight",children:Mn(c?"CommerceUI.CWA.DeviceHandoffCard.ResendNotification":"CommerceUI.CWA.DeviceHandoffCard.ContinueOnDevice")},void 0)},void 0)]},void 0)},void 0)},void 0):(0,a.jsxs)(a.Fragment,{children:[r&&(0,a.jsxs)("div",{className:"device-handoff-card-layout-banner__manual-instruction",children:[(0,a.jsx)(Ye.z,{typography:"body-reduced",weight:"normal",children:Mn("CommerceUI.CWA.DeviceHandoff.ManualInstructions.Heading.Mobile")},void 0),(0,a.jsx)(Ye.xv,{typography:"body-reduced-tight",color:"glyph-gray-secondary",children:r},void 0)]},void 0),t&&(0,a.jsxs)("div",{className:"device-handoff-card-layout-banner__manual-instruction",children:[(0,a.jsx)(Ye.z,{typography:"body-reduced",weight:"normal",children:Mn("CommerceUI.CWA.DeviceHandoff.ManualInstructions.Heading.Desktop")},void 0),(0,a.jsx)(Ye.xv,{typography:"body-reduced-tight",color:"glyph-gray-secondary",children:t},void 0)]},void 0)]},void 0);return(0,a.jsx)("div",{className:gr(["device-handoff-card-layout-banner",i]),"data-test":"device-handoff-card",children:(0,a.jsx)(Ye.Zb,{theme:"banner",shadow:!1,children:(0,a.jsxs)("div",{className:"device-handoff-card-layout-banner__content",children:[(0,a.jsx)("div",{className:"device-handoff-card-layout-banner__title-text",children:(0,a.jsx)(Ye.z,{typography:"body-tight",weight:"normal",children:o},void 0)},void 0),(0,a.jsx)("div",{className:"device-handoff-card-layout-banner__description",children:(0,a.jsx)(Ye.xv,{typography:"body-reduced",color:"glyph-gray-secondary",children:n},void 0)},void 0),u]},void 0)},void 0)},void 0)}var Di=["children","isExternal","isNavigation","newWindow","href"];function Ni(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function Ti(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Ni(Object(t),!0).forEach((function(n){(0,Dt.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ni(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function Ri(e){var n=e.children,t=e.isExternal,r=e.isNavigation,i=e.newWindow,o=e.href,s=(0,Lr.Z)(e,Di);return(0,a.jsxs)("a",Ti(Ti({},s),{},{href:o||"#",rel:"noopener noreferrer",target:i?"_blank":"_self",children:[n,t&&(0,a.jsx)("span",{className:"anchor__external-icon",children:(0,a.jsx)(Ye.JO,{glyph:Ye.og.External},void 0)},void 0)||r&&(0,a.jsx)("span",{className:"anchor__navigation-icon",children:(0,a.jsx)(Ye.JO,{glyph:Ye.og.ChevronRight},void 0)},void 0)]}),void 0)}var Ui=["className","header","children","footer"];function ki(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function Fi(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ki(Object(t),!0).forEach((function(n){(0,Dt.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ki(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function Bi(e){var n=e.className,t=e.header,r=e.children,i=e.footer,o=(0,Lr.Z)(e,Ui);return(0,a.jsxs)("div",Fi(Fi({className:gr(["info-card",n])},o),{},{children:[t&&(0,a.jsx)("div",{children:(0,a.jsx)(Ye.xv,{typography:"body",weight:"semibold",color:"glyph-gray",children:t},void 0)},void 0),r,i&&(0,a.jsx)("div",{className:"info-card__footer",children:i},void 0)]}),void 0)}function Wi(e){var n=e.description,t=e.manualInstructionsDesktop,r=e.manualInstructionsMobile,i=e.className,o=e.title,s=e.isPushEligible,c=e.didSend,d=e.isSending,l=e.handleDeviceHandoff,u=s?(0,a.jsx)("div",{className:"device-handoff-card-layout-info-card__action",children:d?(0,a.jsxs)("div",{className:"device-handoff-card-layout-info-card__action-pending",children:[(0,a.jsx)(Ye.$j,{axLabel:""},void 0),(0,a.jsx)("span",{className:"device-handoff-card-layout-info-card__action-pending-text",children:(0,a.jsx)(Ye.xv,{weight:"medium",children:Mn("CommerceUI.CWA.DeviceHandoffCard.SendingNotification")},void 0)},void 0)]},void 0):(0,a.jsx)("span",{className:"device-handoff-card-layout-info-card__action-button",children:(0,a.jsx)(Ri,{isExternal:!0,onClick:l,"data-test":"device-handoff-card-action-button",children:(0,a.jsx)(Ye.xv,{typography:"body-tight",children:Mn(c?"CommerceUI.CWA.DeviceHandoffCard.ResendNotification.NoEllipsis":"CommerceUI.CWA.DeviceHandoffCard.ContinueOnDevice.NoEllipsis")},void 0)},void 0)},void 0)},void 0):(0,a.jsxs)(a.Fragment,{children:[r&&(0,a.jsxs)("div",{className:"device-handoff-card-layout-info-card__manual-instruction",children:[(0,a.jsx)(Ye.z,{typography:"body-reduced",weight:"normal",children:Mn("CommerceUI.CWA.DeviceHandoff.ManualInstructions.Heading.Mobile")},void 0),(0,a.jsx)(Ye.xv,{typography:"body-reduced-tight",color:"glyph-gray-secondary",children:r},void 0)]},void 0),t&&(0,a.jsxs)("div",{className:"device-handoff-card-layout-info-card__manual-instruction",children:[(0,a.jsx)(Ye.z,{typography:"body-reduced",weight:"normal",children:Mn("CommerceUI.CWA.DeviceHandoff.ManualInstructions.Heading.Desktop")},void 0),(0,a.jsx)(Ye.xv,{typography:"body-reduced-tight",color:"glyph-gray-secondary",children:t},void 0)]},void 0)]},void 0);return(0,a.jsx)(Bi,{className:gr(["device-handoff-card-layout-info-card-layout-banner",i]),"data-test":"device-handoff-card",header:o,footer:u,children:(0,a.jsx)(Ye.xv,{typography:"body",children:n},void 0)},void 0)}function Vi(e){var n=e.type,t=e.action,i=e.description,c=e.manualInstructionsDesktop,d=e.manualInstructionsMobile,l=e.className,u=e.title,p=e.onEvent,m=Pt(),h=(0,s.useState)(!1),f=(0,jt.Z)(h,2),g=f[0],y=f[1],v=(0,s.useState)(!1),C=(0,jt.Z)(v,2),b=C[0],A=C[1],S=(0,s.useState)(!1),x=(0,jt.Z)(S,2),M=x[0],P=x[1];(0,s.useEffect)((function(){(0,r.Z)(o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.getConfiguration();case 2:n=e.sent,P(n.pushEligibility[t]);case 4:case"end":return e.stop()}}),e)})))()}),[m,t]);var I=(0,s.useCallback)((0,r.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,y(!0),null==p||p({action:"requested",isInitialSend:!b}),e.next=5,m.continueOnDevice(t,{onEvent:function(e){return null==p?void 0:p({action:e,isInitialSend:!b})}});case 5:A(!0);case 6:return e.prev=6,y(!1),e.finish(6);case 9:case"end":return e.stop()}}),e,null,[[0,,6,9]])}))),[m,t,p,b]),O="banner"===n?Ei:Wi;return(0,a.jsx)(O,{description:i,title:u,isPushEligible:M,didSend:b,isSending:g,handleDeviceHandoff:I,manualInstructionsDesktop:c,manualInstructionsMobile:d,className:l},void 0)}function _i(e){var n=e.paymentMethod,r=e.width,i=(0,s.useState)([]),o=(0,jt.Z)(i,2),c=o[0],d=o[1],l=n.creditCardType,u=n.paymentMethodType,p=l||u,m=sr(n);if((0,s.useEffect)((function(){if(!m){var e=function(e){return e===er.Maestro?"maestro":(e===nr.ChinaUnionPay?er.ChinaUnionPay:e).toLowerCase().replace(" ","-")}(p);Promise.all([t(6389)("./".concat(e,".png")),t(818)("./".concat(e,"@2x.png")),t(7251)("./".concat(e,"@3x.png"))]).then((function(e){d(e.map((function(e){return e.default})))}))}}),[m,p]),m)return(0,a.jsx)("img",{className:"payment-icon",src:n.applePayCardDetails.cardArtList[0].url,style:{width:r}},void 0);var h="";return c.length<=0?null:(c[0]&&(h+="".concat(c[0]," 1x")),c[1]&&(h+=", ".concat(c[1]," 2x")),c[2]&&(h+=", ".concat(c[2]," 3x")),(0,a.jsx)("img",{className:"payment-icon",srcSet:h,alt:p,style:{width:r}},void 0))}function Zi(e){var n=e.paymentMethod,t=e.onRemoveSuccess,r=e.onDismiss,i=Lt(),o=i.showDialog,s=i.hideDialog,c=ei(n)||"",d=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Ye.dB,{children:(0,a.jsx)(_i,{paymentMethod:n},void 0)},void 0),(0,a.jsx)(Ye.r6,{children:c},void 0)]},void 0),l=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Ye.uN,{typography:"body",children:Mn("CommerceUI.CWA.PaymentMethods.AppleCard.Description")},void 0),(0,a.jsxs)("a",{href:Mn("CommerceUI.CWA.PaymentMethods.AppleCard.Site.URL"),rel:"noopener noreferrer",target:"_blank",children:[Mn("CommerceUI.CWA.PaymentMethods.AppleCard.Site.Label")," ",(0,a.jsx)(Ye.JO,{glyph:Ye.og.External},void 0)]},void 0),(0,a.jsx)(Vi,{type:"banner",title:Mn("CommerceUI.CWA.PaymentMethods.AppleCard.DeviceHandoff.Title"),description:Mn("CommerceUI.CWA.PaymentMethods.AppleCard.DeviceHandoff.Description"),manualInstructionsMobile:Mn("CommerceUI.CWA.PaymentMethods.AppleCard.DeviceHandoff.ManualInstructions"),action:st.hg.PaymentShipping,className:"payment-detail-apple-card__device-handoff"},void 0),(0,a.jsx)("div",{className:"payment-detail-apple-card__remove-button",children:(0,a.jsx)(Ye.zx,{color:"secondary",onClick:function(){o((0,a.jsx)(wi,{paymentId:n.paymentId,onRemoveSuccess:function(){t({shouldReload:!0})},onClose:s,confirmationDescription:Mn("CommerceUI.CWA.PaymentMethods.Remove.AppleCard.Confirmation.Description")},void 0))},children:Mn("CommerceUI.CWA.PaymentMethods.Remove.Card.CTA")},void 0)},void 0)]},void 0);return(0,a.jsx)(vi,{axLabel:c,header:d,body:l,onDismiss:r},void 0)}function $i(e){var n=e.paymentMethod,t=e.onSubmitSuccess,i=e.onDismiss,c=n.paymentMethodType,d=n.paymentId,l=pi(c,d),u=l.addressFormFields,p=l.formValues,m=l.setFormValues,h=l.handleInputChange,f=l.isStackLocked,g=l.paymentFormFields,y=l.validationErrors,v=l.setValidationErrors,C=l.isDirty,b=l.setIsDirty,A=Lt(),S=A.showDialog,x=A.hideDialog,M=(0,s.useState)(""),P=(0,jt.Z)(M,2),I=P[0],O=P[1],j=sr(n),w=qr(n),L=ei(n)||"",E=function(){var e=(0,r.Z)(o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v([]),e.prev=1,e.next=4,Mr(d,p);case 4:return n=e.sent,!ur(n)&&n.result.validationResults&&v(n.result.validationResults),e.abrupt("return",n);case 9:e.prev=9,e.t0=e.catch(1),(0,Nt.Tb)(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}(),D=function(){var e=(0,r.Z)(o().mark((function e(){var n,t,r,i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=p.creditVerificationNumber,t=p.creditCardExpirationMonth,r=p.creditCardExpirationYear,n){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,Ar(d,n,t,r);case 6:return xe(i=e.sent)&&(a=i.errorMessage)&&v([{error:a,errorString:a,propertyName:"creditVerificationNumber"}]),e.abrupt("return",i);case 11:e.prev=11,e.t0=e.catch(3),(0,Nt.Tb)(e.t0),O(Mn("CommerceUI.CWA.GeneralError.Description2"));case 15:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=(0,r.Z)(o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(O(""),!f){e.next=7;break}return e.next=4,D();case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,E();case 9:e.t0=e.sent;case 10:(n=e.t0)&&-1!==n.status&&t({shouldReload:!0});case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Ye.dB,{children:(0,a.jsx)(_i,{paymentMethod:n},void 0)},void 0),(0,a.jsx)(Ye.r6,{children:L},void 0),j&&(0,a.jsx)(Ye.k,{children:Mn("CommerceUI.CWA.PaymentMethods.ApplePay")},void 0)]},void 0),R=(0,a.jsxs)(a.Fragment,{children:[g&&u?(0,a.jsx)(yi,{paymentType:qt.CREDIT_CARD,isApplePay:j,isEditPayment:!0,paymentFormFields:g,addressFormFields:u,formValues:p,setFormValues:m,validationErrors:y,isStackLocked:f,onInputChange:h,setShouldShowSubmit:b},void 0):null,j&&(0,a.jsx)(Vi,{type:"banner",title:Mn("CommerceUI.CWA.PaymentMethods.ApplePayCard.DeviceHandoff.Title"),description:Mn("CommerceUI.CWA.PaymentMethods.ApplePayCard.DeviceHandoff.Description"),manualInstructionsMobile:Mn("CommerceUI.CWA.PaymentMethods.ApplePayCard.DeviceHandoff.ManualInstructions.Mobile"),manualInstructionsDesktop:Mn("CommerceUI.CWA.PaymentMethods.ApplePayCard.DeviceHandoff.ManualInstructions.Desktop"),action:st.hg.PaymentShipping,className:"payment-detail-apple-card__device-handoff"},void 0),(0,a.jsx)("div",{className:"payment-detail-credit-card__remove-button",children:(0,a.jsx)(Ye.zx,{color:"secondary",onClick:function(){S((0,a.jsx)(wi,{paymentId:n.paymentId,onRemoveSuccess:function(){t({shouldReload:!0})},onClose:x,confirmationDescription:Mn(w?"CommerceUI.CWA.PaymentMethods.Remove.AppleCash.Confirmation.Description":j?"CommerceUI.CWA.PaymentMethods.Remove.ApplePayCard.Confirmation.Description":"CommerceUI.CWA.PaymentMethods.Remove.Card.Confirmation.Description",{cardName:L,last4Digits:n.last4CCDigits})},void 0))},"data-test":"remove-card",children:Mn("CommerceUI.CWA.PaymentMethods.Remove.Card.CTA")},void 0)},void 0)]},void 0);return(0,a.jsx)(vi,{axLabel:L,header:T,body:R,error:I,onDismiss:i,onSubmit:N,shouldShowSubmit:C},void 0)}function Ki(e){var n,t=e.paymentMethod,i=e.onSubmitSuccess,c=e.onDismiss,d=t.paymentMethodType,l=t.paymentId,u=pi(d,l).paymentFormFields,p=Lt(),m=p.hideDialog,h=p.showDialog,f=Kr(null===(n=u)||void 0===n?void 0:n.signUpUrl),g=(0,s.useState)(""),y=(0,jt.Z)(g,2),v=y[0],C=y[1],b=ei(t)||"",A=(0,s.useCallback)(function(){var e=(0,r.Z)(o().mark((function e(n){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof(null==n?void 0:n.baToken)){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,Mr(l,{paymentMethodType:d,ba_token:n.baToken});case 5:t=e.sent,ur(t)?C(t.userPresentableErrorMessage):i({shouldReload:!0}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),(0,Nt.Tb)(e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(n){return e.apply(this,arguments)}}(),[l,d,i]);(0,s.useEffect)((function(){return vt(mt,A),function(){Ct(mt,A)}}),[A]);var S=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Ye.dB,{children:(0,a.jsx)(_i,{paymentMethod:t},void 0)},void 0),(0,a.jsx)(Ye.r6,{children:b},void 0),(0,a.jsx)(Ye.k,{children:t.partnerLogin},void 0)]},void 0),x=(0,a.jsxs)(a.Fragment,{children:[v&&(0,a.jsx)(Ye.Bc,{inline:!0,children:v},void 0),(0,a.jsxs)(Ye.uN,{typography:"body",children:[Mn("CommerceUI.CWA.PaymentMethods.ExternalPayment.Description.1"),(0,a.jsxs)(Ye.zx,{link:!0,onClick:function(){f&&open(f,"_blank")},disabled:!f,children:[Mn("CommerceUI.CWA.PaymentMethods.ExternalPayment.Description.2",{partnerName:b})," ",f?(0,a.jsx)(Ye.JO,{glyph:Ye.og.External},void 0):(0,a.jsx)("span",{className:"payment-detail-external__switch-account-spinner",children:(0,a.jsx)(Ye.$j,{axLabel:"",style:{display:"inline-block"}},void 0)},void 0)]},void 0)]},void 0),(0,a.jsx)(Ye.zx,{color:"secondary",onClick:function(){h((0,a.jsx)(wi,{paymentId:t.paymentId,onRemoveSuccess:function(){i({shouldReload:!0})},onClose:m,confirmationDescription:Mn("CommerceUI.CWA.PaymentMethods.Remove.PaymentMethod.Confirmation.Description",{paymentName:b})},void 0))},"data-test":"remove-payment",children:Mn("CommerceUI.CWA.PaymentMethods.Remove.PaymentMethod.CTA",{paymentName:b})},void 0)]},void 0);return(0,a.jsx)(vi,{axLabel:b,header:S,body:x,onDismiss:c},void 0)}function Hi(e){var n=e.paymentMethod,t=e.onDismiss,r=ei(n)||"",i=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Ye.dB,{children:(0,a.jsx)(_i,{paymentMethod:n},void 0)},void 0),(0,a.jsx)(Ye.r6,{children:r},void 0),(0,a.jsx)(Ye.k,{children:Mn("CommerceUI.CWA.PaymentMethods.Balance",{localizedAmount:n.formattedAmountForDisplay})},void 0)]},void 0),o=(0,a.jsx)(Vi,{type:"banner",title:Mn("CommerceUI.CWA.PaymentMethods.StoreCredit.DeviceHandoff.Title"),description:Mn("CommerceUI.CWA.PaymentMethods.StoreCredit.DeviceHandoff.Description"),manualInstructionsMobile:Mn("CommerceUI.CWA.PaymentMethods.StoreCredit.DeviceHandoff.ManualInstructions"),action:st.hg.PaymentShipping,className:"payment-detail-apple-card__device-handoff"},void 0);return(0,a.jsx)(vi,{axLabel:r,header:i,body:o,onDismiss:t},void 0)}function Gi(){var e=Yt(),n=ui(e.get("paymentId")||"").userPaymentInfo,t=Pt(),r=li(),i=r.loadPaymentInfos,o=r.paymentInfos;(0,s.useEffect)((function(){i()}),[i]),(0,s.useEffect)((function(){n&&o&&t.readyToBeShown()}),[t,n,o]);var c=(0,s.useMemo)((function(){if(n&&o)return oi(n,o.lockStatus.isStackLocked)}),[n,o]);if(!c||!n)return null;var d=function(e){var n=e.shouldReload,r=void 0!==n&&n;return t.close({data:{shouldReload:r}})},l=function(){return t.close()};if(c===ii.SmsVerificationAurum||c===ii.SmsVerificationExternal)return(0,a.jsx)(Li,{paymentMethod:n,onDismiss:l,onSubmitSuccess:d},void 0);if(c!==ii.EditPayment)throw new Oe("EditOrChallengeAction",c);return sr(n)&&Xr(n)?(0,a.jsx)(Zi,{paymentMethod:n,onDismiss:l,onRemoveSuccess:d},void 0):dr(n)?(0,a.jsx)($i,{paymentMethod:n,onSubmitSuccess:d,onDismiss:l},void 0):lr(n)?(0,a.jsx)(Hi,{paymentMethod:n,onDismiss:l},void 0):Gr(n.paymentMethodType)?(0,a.jsx)(Ki,{paymentMethod:n,onDismiss:l,onSubmitSuccess:d},void 0):null}const Yi=async e=>Ke(be(B),{method:"POST",body:JSON.stringify(e)});function zi(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function Ji(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?zi(Object(t),!0).forEach((function(n){(0,Dt.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):zi(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function qi(e){var n=e.paymentMethod,t=e.isReorderMode,r=e.onClick,i=e.onMovePaymentUp,o=e.onMovePaymentDown,c=(0,s.useMemo)((function(){return t?{theme:"module",border:!0,shadow:!0}:void 0}),[t]),d=(0,s.useMemo)((function(){return ei(n)}),[n]),l=(0,s.useMemo)((function(){var e,t,r=function(e){var n="",t=sr(e),r=dr(e);if(t){var i=e.applePayCardDetails;qr(e)&&i.balance?n=Mn("CommerceUI.CWA.PaymentMethods.Balance",{localizedAmount:i.balance}):r&&!Xr(e)&&(n=Mn("CommerceUI.CWA.PaymentMethods.ApplePay.Label",{maskedCCNumber:Jr(e)}))}else n=lr(e)?Mn("CommerceUI.CWA.PaymentMethods.Balance",{localizedAmount:e.formattedAmountForDisplay}):ni(e,!0);return n}(n),i=null===(t=null===(e=n.validationErrors)||void 0===e?void 0:e[0])||void 0===t?void 0:t.errorShortMessage;return i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"card-subtitle-container",children:(0,a.jsx)(Ye.xv,{lineClamp:2,children:r},void 0)},void 0),(0,a.jsx)(Ye.xv,{color:"glyph-orange",children:i},void 0)]},void 0):(0,a.jsx)(Ye.xv,{lineClamp:3,children:r},void 0)}),[n]);return(0,a.jsx)("div",{className:"payment-method-module-card",children:(0,a.jsx)(Ye.Oi,Ji({onClick:r,title:d,noWrap:!1,lines:[l],rightElements:[(0,a.jsx)(_i,{paymentMethod:n,width:65},"1")],"data-test":"payment-method-module-card-".concat(n.paymentId),upArrow:i?{onClick:function(e){e.stopPropagation(),i()},label:Mn("CommerceUI.CWA.PaymentMethods.Reorder.UpArrow.AXLabel")}:void 0,downArrow:o?{onClick:function(e){e.stopPropagation(),o()},label:Mn("CommerceUI.CWA.PaymentMethods.Reorder.DownArrow.AXLabel")}:void 0},c),void 0)},void 0)}var Xi=new Set([ii.EditPayment,ii.SmsVerificationAurum,ii.SmsVerificationExternal]);function Qi(e){var n=e.paymentMethods,t=e.storeCredit,r=e.onPaymentMethodClick,i=e.onMovePaymentUp,o=e.onMovePaymentDown,c=e.isReorderMode,d=void 0!==c&&c,l=e.isStackLocked,u=void 0===l||l,p=e.canEditPaymentMethods,m=void 0!==p&&p,h=e.sidebar,f=(0,s.useMemo)((function(){return!!d||!m}),[m,d]),g=(0,a.jsx)(Ye.mR,{spacer:!1,description:!0,children:h},"sidebar");return(0,a.jsxs)(a.Fragment,{children:[t&&(0,a.jsxs)(s.Fragment,{children:[(0,a.jsx)(Ye.mR,{children:(0,a.jsx)(qi,{paymentMethod:t,onClick:function(){return r("storeCredit")}},void 0)},void 0),g]},"storeCredit"),null==n?void 0:n.map((function(e,c){var l=e.paymentId,p=e.rank,m=oi(e,u),h=Xi.has(m)&&zr(e),y=f||(u?!h:f);return(0,a.jsxs)(s.Fragment,{children:[(0,a.jsx)(Ye.mR,{single:0!==c,children:(0,a.jsx)(qi,{paymentMethod:e,isReorderMode:d,onClick:y?void 0:function(){r(l)},onMovePaymentUp:d&&c>0?function(){return i(p)}:void 0,onMovePaymentDown:d&&c<n.length-1?function(){return o(p)}:void 0},void 0)},void 0),0===c&&!t&&g]},l)}))]},void 0)}function eo(e){var n=e.userShippingAddressInfo,t=e.onClick,r=(0,s.useMemo)((function(){var e=n.shippingFirstName,t=n.shippingLastName;return e&&t?"".concat(e," ").concat(t):t||e}),[n]),i=(0,s.useMemo)((function(){var e,t=n.addressShippingCity,r=n.addressShippingStateProvince,i=n.addressShippingPostalCode;t&&(e=r?"".concat(t,","):t);var o=[n.addressShippingLineFirst,n.addressShippingLineSecond,[e,r,i].filter(Boolean).join(" ")].filter(Boolean);return o.length?o:void 0}),[n]);return(0,a.jsx)(Ye.Oi,{onClick:t,theme:"module",title:r,noWrap:!1,lines:i,"data-test":"shipping-address-card"},void 0)}function no(e){var n=e.hasShippingAddress,t=e.shippingFormValues,r=e.onShippingAddressClick;return(0,a.jsx)("div",{className:"shipping-address","data-test":"shipping-address",children:(0,a.jsxs)(Ye.$0,{embedded:!0,children:[(0,a.jsxs)(Ye.M$,{children:[(0,a.jsx)(Ye.NZ,{children:Mn("CommerceUI.CWA.ShippingAddress.Header")},void 0),(0,a.jsx)(Ye.uN,{children:Mn("CommerceUI.CWA.ShippingAddress.Description")},void 0)]},void 0),(0,a.jsx)(Ye.K3,{children:n?(0,a.jsx)(Ye.mR,{children:(0,a.jsx)(eo,{userShippingAddressInfo:t,onClick:r},void 0)},void 0):(0,a.jsx)(Ye.Zb,{theme:"banner",shadow:!1,title:Mn("CommerceUI.CWA.ShippingAddress.NoShippingAddress.Header"),lines:[(0,a.jsx)("div",{children:Mn("CommerceUI.CWA.ShippingAddress.NoShippingAddress.Description")},"description"),(0,a.jsx)(Ye.zx,{link:!0,onClick:r,style:{marginTop:"12px"},children:Mn("CommerceUI.CWA.ShippingAddress.NoShippingAddress.CTA")},"addShippingAddressButton")]},void 0)},void 0)]},void 0)},void 0)}var to=function(e,n){for(var t=xn(e).split(An)||[],r=[],i=0;i<t.length;i++){var o=t[i].split(bn)[1],c=o&&n[o]||t[i];c&&r.push((0,a.jsx)(s.Fragment,{children:c},"p-".concat(i)))}return r};function ro(e){var n=e.hasStoreCredit,t=void 0!==n&&n,r=e.isFamilyHoH,i=void 0!==r&&r,o=e.hasMultiplePaymentMethods,c=void 0!==o&&o,d=e.shouldShowSharedStackMessageOnly,l=void 0!==d&&d,u=e.shouldShowTopOfSharedStackReadOnly,p=void 0!==u&&u,m=(0,s.useMemo)((function(){return t?Mn(i&&c?"CommerceUI.CWA.PaymentMethods.Disclosure.StoreCredit.Family.MultiPMOF":i?"CommerceUI.CWA.PaymentMethods.Disclosure.StoreCredit.Family.SinglePMOF":"CommerceUI.CWA.PaymentMethods.Disclosure.StoreCredit"):i&&c?Mn("CommerceUI.CWA.PaymentMethods.Disclosure.Family.MultiPMOF"):i?Mn("CommerceUI.CWA.PaymentMethods.Disclosure.Family.SinglePMOF"):c?Mn("CommerceUI.CWA.PaymentMethods.Disclosure.MultiPMOF"):void 0}),[t,i,c]);return l?(0,a.jsx)(Ye.uN,{children:Mn("CommerceUI.CWA.PaymentMethods.FamilySharing.Description")},void 0):p?(0,a.jsx)(Ye.uN,{children:Mn("CommerceUI.CWA.PaymentMethods.FamilySharing.Description.SharingTopOfStackOnly")},void 0):(0,a.jsxs)(a.Fragment,{children:[m&&(0,a.jsx)("p",{children:(0,a.jsx)(Ye.uN,{block:!1,children:m},void 0)},void 0),(0,a.jsx)("p",{children:(0,a.jsx)(Ye.uN,{block:!1,children:to("CommerceUI.CWA.Layout.LearnMoreTextWithLink",{text:Mn("CommerceUI.CWA.PaymentMethods.Disclosure.MultiplePaymentMethods"),link:(0,a.jsx)(Ri,{isExternal:!0,newWindow:!0,href:Mn("CommerceUI.CWA.PaymentMethods.Disclosure.MultiplePaymentMethods.LearnMore.Url"),children:Mn("CommerceUI.CWA.PaymentMethods.Disclosure.MultiplePaymentMethods.LearnMore.Label")},void 0)})},void 0)},void 0),(0,a.jsx)("p",{children:(0,a.jsx)(Ye.uN,{block:!1,children:to("CommerceUI.CWA.Layout.LearnMoreTextWithLink",{text:Mn("CommerceUI.CWA.PaymentMethods.Disclosure.AvailablePaymentMethods"),link:(0,a.jsx)(Ri,{isExternal:!0,newWindow:!0,href:Mn("CommerceUI.CWA.PaymentMethods.Disclosure.AvailablePaymentMethods.LearnMore.Url"),children:Mn("CommerceUI.CWA.PaymentMethods.Disclosure.AvailablePaymentMethods.LearnMore.Label")},void 0)})},void 0)},void 0)]},void 0)}function io(){var e=Pt(),n=(0,s.useState)(),t=(0,jt.Z)(n,2),i=t[0],c=t[1],d=(0,s.useState)([]),l=(0,jt.Z)(d,2),u=l[0],p=l[1],m=mi(),h=m.formValues,f=m.hasShippingAddress,g=(0,s.useState)(!1),y=(0,jt.Z)(g,2),v=y[0],C=y[1],b=(0,s.useState)(!1),A=(0,jt.Z)(b,2),S=A[0],x=A[1],M=li(),P=M.paymentInfos,I=M.loadPaymentInfos;(0,s.useEffect)((function(){(0,r.Z)(o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all([I(),Ke(be("paymentOptionsSrv"))]);case 3:n=e.sent,c(n[1]),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),(0,Nt.Tb)(e.t0),console.error("Failed to load paymentInfos or paymentOptions",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))()}),[I]),(0,s.useEffect)((function(){P&&(p(ti(P.userPaymentInfos)),e.readyToBeShown())}),[P,e]);var O=(0,s.useMemo)((function(){return null==P?void 0:P.storeCredit}),[P]),j=(0,s.useMemo)((function(){return null==P?void 0:P.messages}),[P]),w=(0,s.useMemo)((function(){var e;return null===(e=null==P?void 0:P.lockStatus.isStackLocked)||void 0===e||e}),[P]),L=(0,s.useMemo)((function(){return 1===(e=u).length&&e[0].paymentMethodType===qt.NONE;var e}),[u]),E=(0,s.useMemo)((function(){return Boolean((null==i?void 0:i.isFamilyMember)&&!i.isFamilyHoH&&i.isInFamilySharingEntireStack)}),[i]),D=(0,s.useMemo)((function(){return Boolean((null==i?void 0:i.isFamilyMember)&&!i.isFamilyHoH&&!i.isInFamilySharingEntireStack)}),[i]),N=(0,s.useMemo)((function(){return!(!w&&!D)||(null==u?void 0:u.filter((function(e){return e.paymentMethodType!==qt.NONE})).length)<2}),[w,D,u]),T=(0,s.useMemo)((function(){return!!w||!!(null==i?void 0:i.isFamilyMember)&&!i.isFamilyHoH}),[w,i]);if(!P||!i)return null;var R,U=null==j?void 0:j.map((function(e){var n=e.message,t=e.messageKey;return(0,a.jsx)(Ye.Bc,{inline:!0,children:n},t)})),k=function(){var n=(0,r.Z)(o().mark((function n(t){var r;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.openModule("amp-edit-payment",{params:{paymentId:t},data:{paymentInfos:P}});case 2:(null==(r=n.sent)?void 0:r.shouldReload)&&location.reload();case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),F=function(){var n=(0,r.Z)(o().mark((function n(){var t;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.openModule("amp-payments",{path:"/shipping/edit",params:{hasShippingAddress:f},data:{paymentInfos:P}});case 2:(null==(t=n.sent)?void 0:t.shouldReload)&&location.reload();case 4:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),B=function(){var n=(0,r.Z)(o().mark((function n(){var t;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.openModule("amp-add-payment",{data:{paymentInfos:P}});case 2:(null==(t=n.sent)?void 0:t.shouldReload)&&location.reload();case 4:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),W=(0,a.jsx)("div",{className:"payment-methods__sidebar",children:v?(0,a.jsx)(Ye.zx,{onClick:(R=(0,r.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(!0),e.next=3,Yi(ri(u));case 3:x(!1),C(!1);case 5:case"end":return e.stop()}}),e)}))),function(){return R.apply(this,arguments)}),disabled:S,"data-test":"reorder-submit",children:Mn("CommerceUI.CWA.PaymentMethods.Reorder.Done")},void 0):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"payment-methods__link",children:(0,a.jsx)(Ye.zx,{onClick:B,"data-test":"add-payment-method",link:!0,disabled:T,children:(0,a.jsxs)(Ye.xv,{block:!0,typography:"body-reduced",children:[(0,a.jsx)(Cr,{variant:"plus-circle",width:"1rem",height:"1rem",className:"payment-methods__icon"},void 0),Mn("CommerceUI.CWA.PaymentMethods.AddPaymentMethod.Button.Label")]},void 0)},void 0)},void 0),(0,a.jsx)("div",{className:"payment-methods__link",children:(0,a.jsx)(Ye.zx,{onClick:function(){C(!v)},"data-test":"reorder-payment-methods",link:!0,disabled:N,children:(0,a.jsxs)(Ye.xv,{block:!0,typography:"body-reduced",children:[(0,a.jsx)(Cr,{variant:"arrow-up-and-down-circle",width:"1rem",height:"1rem",className:"payment-methods__icon"},void 0),Mn("CommerceUI.CWA.PaymentMethods.Reorder.Button.Label")]},void 0)},void 0)},void 0)]},void 0)},void 0);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:gr({"payment-methods":!0,"payment-methods--family-shared-stack-message-only":E}),"data-test":"payment-methods",children:(0,a.jsxs)(Ye.$0,{embedded:!0,children:[(0,a.jsxs)(Ye.M$,{children:[(0,a.jsx)(Ye.NZ,{children:Mn("CommerceUI.CWA.PaymentMethods.Header")},void 0),!L&&(0,a.jsx)(ro,{hasStoreCredit:!!O,isFamilyHoH:i.isFamilyMember&&i.isFamilyHoH,hasMultiplePaymentMethods:u.length>1,shouldShowSharedStackMessageOnly:E,shouldShowTopOfSharedStackReadOnly:D},void 0),(0,a.jsx)("div",{className:"payment-methods__messages",children:U},void 0),!L&&W]},void 0),!E&&(0,a.jsx)(Ye.K3,{children:L&&!O?(0,a.jsx)(Ye.Zb,{theme:"banner",shadow:!1,title:Mn("CommerceUI.CWA.PaymentMethods.NoPMOF.Title"),lines:[(0,a.jsx)("div",{children:Mn("CommerceUI.CWA.PaymentMethods.NoPMOF.Description")},"description"),(0,a.jsx)(Ye.zx,{link:!0,onClick:B,"data-test":"add-payment-method",style:{marginTop:"12px"},disabled:T,children:Mn("CommerceUI.CWA.PaymentMethods.AddPaymentMethod.Button.Label")},"addPaymentButton")]},void 0):(0,a.jsx)(Qi,{paymentMethods:L?void 0:u,storeCredit:O,onPaymentMethodClick:k,onMovePaymentUp:function(e){var n=((e,n)=>{const t=Math.max(e-1,1),r=n.map((n=>n.rank===e?{...n,rank:t}:n.rank===t?{...n,rank:t+1}:n));return ti(r)})(e,u);p(n)},onMovePaymentDown:function(e){var n=((e,n)=>{const t=Math.min(e+1,n.length),r=n.map((n=>n.rank===e?{...n,rank:t}:n.rank===t?{...n,rank:t-1}:n));return ti(r)})(e,u);p(n)},isReorderMode:v,isStackLocked:w,canEditPaymentMethods:!D,sidebar:W},void 0)},void 0)]},void 0)},void 0),(0,a.jsx)(no,{hasShippingAddress:f,shippingFormValues:h,onShippingAddressClick:F},void 0)]},void 0)}function oo(){return(0,a.jsx)(di,{children:(0,a.jsx)(l.j3,{},void 0)},void 0)}const ao=async e=>Ke(be(k),{method:"POST",body:JSON.stringify(e)}),so=async()=>Ke(be(F),{method:"POST"});var co=[];function lo(e){var n=e.formFields,t=e.formValues,r=e.validationErrors,i=e.isCopyBillingAddressChecked,o=e.onInputChange,c=e.onCopyBillingAddressChange,d=(0,s.useMemo)((function(){var e=[],t=[],r=[],i=[],o=[],a=[];return n.order.flat().forEach((function(n){["shippingFirstName","shippingLastName"].includes(n)?e.push(n):["addressShippingLineFirst","addressShippingLineSecond"].includes(n)?t.push(n):"addressShippingCompanyName"===n?r.push(n):["addressShippingCity","addressShippingStateProvince","addressShippingPostalCode"].includes(n)?i.push(n):"addressShippingCountryCode"===n?o.push(n):co.includes(n)||a.push([n])})),[e,t,r,i,o].concat(a)}),[n.order]);return(0,a.jsxs)("form",{children:[c&&(0,a.jsx)("div",{className:"shipping-address-form__copy-billing",children:(0,a.jsx)(Ye.XZ,{onChange:c,checked:i,"data-test":"copy-billing-checkbox",children:(0,a.jsx)(Ye.xv,{typography:"body-reduced",color:"glyph-gray-secondary",children:Mn("CommerceUI.CWA.ShippingAddress.CopyBillingAddress.Label")},void 0)},void 0)},void 0),(0,a.jsx)(Wr,{formFields:n,formFieldsOrder:d,formValues:t,validationErrors:r,onInputChange:o,testIdPrefix:"shipping-field",disabledFieldIds:["addressShippingCountryCode"],excludedFieldIds:co},void 0)]},void 0)}function uo(){var e=Yt(),n=Pt(),t=mi(),i=t.formFields,c=t.formValues,d=t.setFormValues,l=t.validationErrors,u=t.setValidationErrors,p=t.handleInputChange,m=t.isDirty,h=t.setIsDirty,f=t.defaultBillingAddress,g=(0,s.useState)(!1),y=(0,jt.Z)(g,2),v=y[0],C=y[1],b=(0,s.useState)(""),A=(0,jt.Z)(b,2),S=A[0],x=A[1],M=(0,s.useState)(!1),P=(0,jt.Z)(M,2),I=P[0],O=P[1],j=(0,s.useState)({}),w=(0,jt.Z)(j,2),L=w[0],E=w[1],D=Lt(),N=D.showDialog,T=D.hideDialog,R=fr().showAlertDialog,U=li().loadPaymentInfos;(0,s.useEffect)((function(){U()}),[U]),(0,s.useEffect)((function(){i&&n.readyToBeShown()}),[n,i]);var k=function(){return n.close({data:{shouldReload:!0}})},F=function(){var e=(0,r.Z)(o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((n=null==i?void 0:i.order.flat().map((function(e){var n;if((null===(n=i[e])||void 0===n?void 0:n.required)&&c&&!c[e])return{propertyName:e,errorString:Mn("CommerceUI.CWA.ShippingAddress.Form.Validation.Required")}})).filter(Boolean)).length>0)){e.next=5;break}u(n),e.next=20;break;case 5:if(!c){e.next=20;break}return C(!0),e.prev=7,e.next=10,ao(c);case 10:k(),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(7),(0,Nt.Tb)(e.t0),x(Mn("CommerceUI.CWA.GeneralError.Description2"));case 17:return e.prev=17,C(!1),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[7,13,17,20]])})));return function(){return e.apply(this,arguments)}}(),B=function(){var e=(0,r.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:N((0,a.jsx)(Oi,{title:Mn("CommerceUI.CWA.ShippingAddress.Remove.Confirmation.Header"),description:Mn("CommerceUI.CWA.ShippingAddress.Remove.Confirmation.Description"),cancelButtonLabel:Mn("CommerceUI.CWA.ShippingAddress.Remove.Confirmation.Cancel"),confirmButtonLabel:Mn("CommerceUI.CWA.ShippingAddress.Remove.Confirmation.Confirm"),onConfirm:so,onSuccess:k,onFailure:function(){R({title:Mn("CommerceUI.CWA.ShippingAddress.Remove.Failure.Header"),description:Mn("CommerceUI.CWA.ShippingAddress.Remove.Failure.Description"),okButtonTitle:Mn("CommerceUI.CWA.ShippingAddress.Remove.Failure.CTA")})},onClose:T},void 0));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),W=(0,s.useCallback)((function(){var e=!I;O(e),E(c),d(e&&f?(e=>{const{billingFirstName:n,billingLastName:t,addressOfficialLineFirst:r,addressOfficialLineSecond:i,addressOfficialCity:o,addressOfficialStateProvince:a,addressOfficialPostalCode:s,addressOfficialCountryCode:c}=e;return{shippingFirstName:n,shippingLastName:t,addressShippingLineFirst:r,addressShippingLineSecond:i,addressShippingCity:o,addressShippingStateProvince:a,addressShippingPostalCode:s,addressShippingCountryCode:c}})(f):L),h(!0)}),[f,I,d,h,c,L,E]);return i?(0,a.jsxs)(Ye.u_,{visible:!0,onDismiss:function(){return n.close()},axLabel:Mn("CommerceUI.CWA.ShippingAddress.Form.Header"),axCloseButtonLabel:Mn("CommerceUI.AX.Close"),children:[(0,a.jsxs)(Ye.hz,{disabled:v,children:[(0,a.jsxs)(Ye.xB,{children:[(0,a.jsx)(Ye.dB,{children:(0,a.jsx)(Cr,{variant:"house",width:55,height:55},void 0)},void 0),(0,a.jsx)(Ye.r6,{children:Mn("CommerceUI.CWA.ShippingAddress.Form.Header")},void 0),(0,a.jsx)(Ye.k,{children:Mn("CommerceUI.CWA.ShippingAddress.Form.Description")},void 0)]},void 0),(0,a.jsxs)(Ye.fe,{children:[S&&(0,a.jsx)(Ye.Bc,{inline:!0,children:S},void 0),(0,a.jsx)(lo,{formFields:i,formValues:c,validationErrors:l,onInputChange:function(){O(!1),p.apply(void 0,arguments)},isCopyBillingAddressChecked:I,onCopyBillingAddressChange:W},void 0),"true"===e.get("hasShippingAddress")&&(0,a.jsx)(Ye.zx,{color:"secondary",onClick:B,"data-test":"remove-address",children:Mn("CommerceUI.CWA.ShippingAddress.Remove.CTA")},void 0)]},void 0)]},void 0),m&&(0,a.jsx)(Ye.dm,{centered:!0,children:(0,a.jsx)(Ye.zx,{type:"submit",onClick:F,disabled:v,children:Mn("CommerceUI.CWA.ShippingAddress.Form.Submit")},void 0)},void 0)]},void 0):null}const po=()=>{const e=Yt(),n=(0,s.useMemo)((()=>e.get("subscriptionId")||void 0),[e]),t=(0,s.useMemo)((()=>e.get("ampReferenceNumber")||e.get("amp_reference_number")||void 0),[e]),r=(0,s.useMemo)((()=>!(!n&&!t)),[n,t]);return{subscriptionId:n,ampReferenceNumber:t,hasSubscriptionQueryParam:r}};var mo,ho,fo=(0,s.createContext)({loadSubscriptionDetailsRequestState:0,loadSubscriptionDetailsById:(ho=(0,r.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return ho.apply(this,arguments)}),loadSubscriptionDetailsByAmpReferenceNumber:(mo=(0,r.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return mo.apply(this,arguments)}),setSubscription:function(){}});function go(){return(0,s.useContext)(fo)}it()&&document.body.classList.add("is-embedded-on-cwa"),(0,r.Z)(o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p("commerce_ui_cwa",{releaseVersion:document.querySelector('[name="version"]').content}),Ce(),e.next=4,He();case 4:n=e.sent,Ae(n.webBag),c.render((0,a.jsx)(s.StrictMode,{children:(0,a.jsx)(d.VK,{basename:"/includes/cwa/",children:(0,a.jsxs)(l.Z5,{children:[(0,a.jsxs)(l.AW,{path:"/",element:(0,a.jsx)(Ht,{},void 0),children:[(0,a.jsxs)(l.AW,{element:(0,a.jsx)(oo,{},void 0),children:[(0,a.jsx)(l.AW,{path:Xn,element:(0,a.jsx)(io,{},void 0)},void 0),(0,a.jsx)(l.AW,{path:Qn,element:(0,a.jsx)(Gi,{},void 0)},void 0),(0,a.jsx)(l.AW,{path:et,element:(0,a.jsx)(Ci,{},void 0)},void 0),(0,a.jsx)(l.AW,{path:"/payments/shipping/edit",element:(0,a.jsx)(uo,{},void 0)},void 0)]},void 0),(0,a.jsx)(l.AW,{path:tt,element:(0,a.jsx)(Jt,{},void 0)},void 0),!1,(0,a.jsx)(l.AW,{path:nt,element:(0,a.jsx)(qn,{},void 0)},void 0)]},void 0),(0,a.jsx)(l.AW,{path:"/logout",element:(0,a.jsx)(Gt,{},void 0)},void 0)]},void 0)},void 0)},void 0),document.getElementById("root"));case 7:case"end":return e.stop()}}),e)})))()},818:(e,n,t)=>{var r={"./amex@2x.png":[7406,406],"./apple-card@2x.png":[2377,377],"./diners-club@2x.png":[1102,102],"./discover@2x.png":[3120,120],"./maestro@2x.png":[7894,894],"./mastercard@2x.png":[1173,173],"./paypal@2x.png":[2352,352],"./storecredit@2x.png":[4177,177],"./upcc@2x.png":[3835,835],"./visa@2x.png":[8453,453]};function i(e){if(!t.o(r,e))return Promise.resolve().then((()=>{var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=r[e],i=n[0];return t.e(n[1]).then((()=>t.t(i,17)))}i.keys=()=>Object.keys(r),i.id=818,e.exports=i},7251:(e,n,t)=>{var r={"./amex@3x.png":[8233,233],"./apple-card@3x.png":[8105,105],"./diners-club@3x.png":[7565,565],"./discover@3x.png":[1593,593],"./maestro@3x.png":[9344,344],"./mastercard@3x.png":[2518,518],"./paypal@3x.png":[8877,877],"./storecredit@3x.png":[7007,7],"./upcc@3x.png":[807,807],"./visa@3x.png":[9406,384]};function i(e){if(!t.o(r,e))return Promise.resolve().then((()=>{var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=r[e],i=n[0];return t.e(n[1]).then((()=>t.t(i,17)))}i.keys=()=>Object.keys(r),i.id=7251,e.exports=i},6389:(e,n,t)=>{var r={"./amex.png":[9321,321],"./amex@2x.png":[7406,406],"./amex@3x.png":[8233,233],"./apple-card.png":[5502,502],"./apple-card@2x.png":[2377,377],"./apple-card@3x.png":[8105,105],"./diners-club.png":[1773,773],"./diners-club@2x.png":[1102,102],"./diners-club@3x.png":[7565,565],"./discover.png":[5542,542],"./discover@2x.png":[3120,120],"./discover@3x.png":[1593,593],"./maestro.png":[4781,781],"./maestro@2x.png":[7894,894],"./maestro@3x.png":[9344,344],"./mastercard.png":[9337,337],"./mastercard@2x.png":[1173,173],"./mastercard@3x.png":[2518,518],"./paypal.png":[9979,979],"./paypal@2x.png":[2352,352],"./paypal@3x.png":[8877,877],"./storecredit.png":[1713,713],"./storecredit@2x.png":[4177,177],"./storecredit@3x.png":[7007,7],"./upcc.png":[5616,616],"./upcc@2x.png":[3835,835],"./upcc@3x.png":[807,807],"./visa.png":[9190,190],"./visa@2x.png":[8453,453],"./visa@3x.png":[9406,384]};function i(e){if(!t.o(r,e))return Promise.resolve().then((()=>{var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=r[e],i=n[0];return t.e(n[1]).then((()=>t.t(i,17)))}i.keys=()=>Object.keys(r),i.id=6389,e.exports=i}},e=>{e.O(0,[216],(()=>(4170,e(e.s=4170)))),e.O()}]);